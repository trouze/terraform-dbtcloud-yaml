{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"INDEX/","title":"dbt-terraform-modules-yaml","text":"<p>Manage your entire dbt Cloud setup with infrastructure-as-code using Terraform and YAML. Define projects, repositories, environments, credentials, and jobs in a single, human-readable YAML file.</p>"},{"location":"INDEX/#why-this-project-exists","title":"Why This Project Exists","text":"<p>Setting up dbt Cloud via Terraform requires writing complex HCL for every resource. This module simplifies that by letting you define your infrastructure in YAML - the language data teams already know. No need to learn Terraform syntax just to configure dbt.</p> <p>Benefits:</p> <ul> <li>\u2705 YAML-based configuration - intuitive for data engineers</li> <li>\u2705 Infrastructure as Code - version control your dbt setup</li> <li>\u2705 Multi-provider Git support - GitHub, GitLab, Azure DevOps, SSH</li> <li>\u2705 Complete resource management - projects, repos, environments, credentials, jobs</li> <li>\u2705 Environment variable management - set dbt variables alongside infrastructure</li> <li>\u2705 Reusable modules - standardize your dbt deployments</li> </ul>"},{"location":"INDEX/#quick-start","title":"Quick Start","text":"<p>Get started in 3 simple steps:</p>"},{"location":"INDEX/#quick-start_1","title":"Quick Start","text":"<p>Get started in 3 simple steps:</p> Step 1: Clone the ExampleStep 2: Configure CredentialsStep 3: Deploy <pre><code># Clone or copy the basic example\ngit clone https://github.com/trouze/dbt-terraform-modules-yaml.git\ncd dbt-terraform-modules-yaml/examples/basic\n\n# Or copy to your own directory\ncp -r examples/basic my-dbt-setup\ncd my-dbt-setup\n</code></pre> <pre><code># Create .env file from example\ncp .env.example .env\n\n# Edit with your dbt Cloud credentials\nexport TF_VAR_dbt_account_id=12345\nexport TF_VAR_dbt_api_token=dbtc_xxxxx\nexport TF_VAR_dbt_pat=dbtc_xxxxx\nexport TF_VAR_dbt_host_url=https://cloud.getdbt.com/api\nexport TF_VAR_yaml_file_path=./dbt-config.yml\n</code></pre> <pre><code># Load credentials\nsource .env\n\n# Initialize and deploy\nterraform init\nterraform plan\nterraform apply\n</code></pre> <p>That's it!</p> <p>Your dbt Cloud project is now managed with infrastructure-as-code!</p>"},{"location":"INDEX/#features","title":"Features","text":""},{"location":"INDEX/#yaml-configuration","title":"YAML Configuration","text":"<p>Define everything in one file:</p> <pre><code>project:\n  name: \"my-dbt-project\"\n  repository:\n    remote_url: \"https://github.com/myorg/myrepo.git\"\n    git_clone_strategy: \"github_app\"\n    github_installation_id: 123456\n\n  environments:\n    - name: \"Production\"\n      type: \"deployment\"\n      connection_id: 1\n      jobs:\n        - name: \"daily_run\"\n          execute_steps:\n            - \"dbt run\"\n          triggers:\n            schedule: true\n            schedule_hours: [6]\n</code></pre>"},{"location":"INDEX/#multi-provider-git-support","title":"Multi-Provider Git Support","text":"<p>Automatically configures your Git provider:</p> <ul> <li>GitHub with GitHub App</li> <li>GitLab with Deploy Token</li> <li>Azure DevOps with Azure AD</li> <li>SSH Deploy Key (universal)</li> </ul>"},{"location":"INDEX/#secure-credentials","title":"Secure Credentials","text":"<ul> <li>Keep secrets in <code>.env</code> or GitHub Secrets</li> <li>Never commit sensitive values</li> <li>Support for database credentials as environment variables</li> </ul>"},{"location":"INDEX/#use-cases","title":"Use Cases","text":"<ul> <li> <p> Single dbt Project</p> <p>Get started quickly with a single project</p> <pre><code>terraform apply\n</code></pre> </li> <li> <p> Multiple Projects</p> <p>Run multiple dbt projects in parallel CI/CD</p> <pre><code># Run each project separately\nfor config in configs/*.yml; do\n  terraform plan -var=\"yaml_file_path=$config\"\ndone\n</code></pre> </li> <li> <p> CI/CD Pipeline</p> <p>Automate deployments with GitHub Actions</p> <pre><code># GitHub Actions example\n- env:\n    TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n    TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n  run: terraform apply\n</code></pre> </li> </ul>"},{"location":"INDEX/#requirements","title":"Requirements","text":"<ul> <li>Terraform &gt;= 1.0</li> <li>dbt Cloud account</li> <li>dbt Cloud API token</li> <li>Git repository for your dbt models</li> </ul>"},{"location":"INDEX/#whats-next","title":"What's Next?","text":"<ul> <li> <p> Getting Started</p> <p>Follow the quick start guide to deploy your first dbt Cloud project</p> <p> Quick Start</p> </li> <li> <p> Configuration</p> <p>Learn about YAML schema and configuration options</p> <p> Configuration</p> </li> <li> <p> Examples</p> <p>Explore real-world examples and use cases</p> <p> Examples</p> </li> <li> <p> Reference</p> <p>Complete Terraform module API documentation</p> <p> Module API</p> </li> </ul>"},{"location":"INDEX/#community-support","title":"Community &amp; Support","text":"<ul> <li>\ud83d\udcd6 Documentation - You're reading it!</li> <li>\ud83d\udc1b Issues - Report bugs or request features</li> <li>\ud83d\udcac Discussions - Share ideas and best practices</li> </ul>"},{"location":"INDEX/#license","title":"License","text":"<p>This project is licensed under Apache License 2.0. See LICENSE for details.</p> <p>Ready to manage your dbt Cloud with code? Start with the Quick Start Guide!</p>"},{"location":"configuration/environment-variables/","title":"Environment Variables","text":"<p>Learn how to manage credentials and configuration using environment variables.</p>"},{"location":"configuration/environment-variables/#overview","title":"Overview","text":"<p>This module uses Terraform's <code>TF_VAR_</code> prefix pattern to pass sensitive values without hardcoding them in <code>.tf</code> files. This approach works seamlessly in both local development (<code>.env</code> files) and CI/CD (GitHub Secrets, etc.).</p>"},{"location":"configuration/environment-variables/#required-variables","title":"Required Variables","text":"<p>These variables must be set for the module to function:</p> Variable Description Example <code>TF_VAR_dbt_account_id</code> Your dbt Cloud account ID <code>12345</code> <code>TF_VAR_dbt_api_token</code> dbt Cloud API token <code>dbtc_xxxxx...</code> <code>TF_VAR_dbt_pat</code> dbt Cloud Personal Access Token <code>dbtc_xxxxx...</code> <code>TF_VAR_dbt_host_url</code> dbt Cloud API endpoint <code>https://cloud.getdbt.com/api</code> <code>TF_VAR_yaml_file_path</code> Path to your YAML config <code>./dbt-config.yml</code>"},{"location":"configuration/environment-variables/#optional-variables","title":"Optional Variables","text":"Variable Description Default <code>TF_VAR_token_map</code> Map of database credential tokens <code>{}</code> <code>TF_VAR_target_name</code> dbt target name <code>null</code>"},{"location":"configuration/environment-variables/#local-development-setup","title":"Local Development Setup","text":""},{"location":"configuration/environment-variables/#using-env-files","title":"Using .env Files","text":"<p>The recommended approach for local development:</p>"},{"location":"configuration/environment-variables/#step-1-create-env-file","title":"Step 1: Create .env File","text":"<pre><code># Create from example\ncp .env.example .env\n</code></pre>"},{"location":"configuration/environment-variables/#step-2-edit-with-your-values","title":"Step 2: Edit with Your Values","text":".env<pre><code># dbt Cloud Configuration\nexport TF_VAR_dbt_account_id=12345\nexport TF_VAR_dbt_api_token=dbtc_xxxxxxxxxxxxx\nexport TF_VAR_dbt_pat=dbtc_xxxxxxxxxxxxx\nexport TF_VAR_dbt_host_url=https://cloud.getdbt.com/api\n\n# YAML Configuration Path\nexport TF_VAR_yaml_file_path=./dbt-config.yml\n\n# Database Credentials (JSON format, single line)\nexport TF_VAR_token_map='{\"prod_databricks\":\"dapi123\",\"dev_snowflake\":\"abc456\"}'\n</code></pre> <p>JSON Format for token_map</p> <p>The <code>token_map</code> must be valid single-line JSON. Use single quotes around the entire value.</p>"},{"location":"configuration/environment-variables/#step-3-load-variables","title":"Step 3: Load Variables","text":"<pre><code># Load into current shell\nsource .env\n\n# Verify they're set\necho $TF_VAR_dbt_account_id\n</code></pre>"},{"location":"configuration/environment-variables/#step-4-run-terraform","title":"Step 4: Run Terraform","text":"<pre><code>terraform plan\nterraform apply\n</code></pre>"},{"location":"configuration/environment-variables/#using-terraformtfvars-alternative","title":"Using terraform.tfvars (Alternative)","text":"<p>If you prefer HCL syntax:</p> terraform.tfvars<pre><code>dbt_account_id  = 12345\ndbt_api_token   = \"dbtc_xxxxxxxxxxxxx\"\ndbt_pat         = \"dbtc_xxxxxxxxxxxxx\"\ndbt_host_url    = \"https://cloud.getdbt.com/api\"\nyaml_file_path  = \"./dbt-config.yml\"\n\ntoken_map = {\n  prod_databricks = \"dapi123\"\n  dev_snowflake   = \"abc456\"\n}\n</code></pre> <p>Never Commit terraform.tfvars</p> <p>Add to <code>.gitignore</code>: <pre><code>terraform.tfvars\n*.tfvars\n!*.tfvars.example\n</code></pre></p>"},{"location":"configuration/environment-variables/#cicd-setup","title":"CI/CD Setup","text":""},{"location":"configuration/environment-variables/#github-actions","title":"GitHub Actions","text":"<p>Store secrets in GitHub Settings &gt; Secrets and variables &gt; Actions:</p> .github/workflows/deploy.yml<pre><code>name: Deploy dbt Cloud\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n\n      - name: Terraform Init\n        run: terraform init\n\n      - name: Terraform Apply\n        env:\n          TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n          TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n          TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n          TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n          TF_VAR_yaml_file_path: ./dbt-config.yml\n          TF_VAR_token_map: ${{ secrets.TOKEN_MAP }}\n        run: terraform apply -auto-approve\n</code></pre> <p>Required GitHub Secrets: - <code>DBT_ACCOUNT_ID</code> - <code>DBT_API_TOKEN</code> - <code>DBT_PAT</code> - <code>TOKEN_MAP</code> (JSON string: <code>{\"key\":\"value\"}</code>)</p>"},{"location":"configuration/environment-variables/#gitlab-cicd","title":"GitLab CI/CD","text":"<p>Store in Settings &gt; CI/CD &gt; Variables (masked &amp; protected):</p> .gitlab-ci.yml<pre><code>deploy:\n  image: hashicorp/terraform:latest\n  stage: deploy\n  variables:\n    TF_VAR_dbt_account_id: $DBT_ACCOUNT_ID\n    TF_VAR_dbt_api_token: $DBT_API_TOKEN\n    TF_VAR_dbt_pat: $DBT_PAT\n    TF_VAR_dbt_host_url: \"https://cloud.getdbt.com/api\"\n    TF_VAR_yaml_file_path: \"./dbt-config.yml\"\n    TF_VAR_token_map: $TOKEN_MAP\n  script:\n    - terraform init\n    - terraform apply -auto-approve\n  only:\n    - main\n</code></pre>"},{"location":"configuration/environment-variables/#azure-devops","title":"Azure DevOps","text":"<p>Store in Pipelines &gt; Library &gt; Variable groups:</p> azure-pipelines.yml<pre><code>trigger:\n  - main\n\npool:\n  vmImage: 'ubuntu-latest'\n\nvariables:\n  - group: dbt-cloud-credentials\n\nsteps:\n  - task: TerraformInstaller@0\n    inputs:\n      terraformVersion: 'latest'\n\n  - task: TerraformTaskV2@2\n    inputs:\n      command: 'init'\n\n  - task: TerraformTaskV2@2\n    inputs:\n      command: 'apply'\n      environmentServiceNameAzureRM: 'terraform'\n    env:\n      TF_VAR_dbt_account_id: $(DBT_ACCOUNT_ID)\n      TF_VAR_dbt_api_token: $(DBT_API_TOKEN)\n      TF_VAR_dbt_pat: $(DBT_PAT)\n      TF_VAR_dbt_host_url: 'https://cloud.getdbt.com/api'\n      TF_VAR_yaml_file_path: './dbt-config.yml'\n      TF_VAR_token_map: $(TOKEN_MAP)\n</code></pre>"},{"location":"configuration/environment-variables/#token-map-configuration","title":"Token Map Configuration","text":"<p>The <code>token_map</code> variable maps credential names in your YAML to actual database tokens.</p>"},{"location":"configuration/environment-variables/#how-it-works","title":"How It Works","text":"<p>In your YAML:</p> <pre><code>environments:\n  - name: \"Production\"\n    credential:\n      token_name: \"prod_databricks_token\"  # \u2190 This is the key\n      schema: \"analytics\"\n</code></pre> <p>In your environment variables:</p> <pre><code>export TF_VAR_token_map='{\"prod_databricks_token\":\"dapi_abc123xyz\"}'\n#                         \u2191 Must match              \u2191 Actual token\n</code></pre>"},{"location":"configuration/environment-variables/#multiple-credentials-example","title":"Multiple Credentials Example","text":"<pre><code># Multiple database credentials\nexport TF_VAR_token_map='{\n  \"prod_databricks\": \"dapi_prod123\",\n  \"dev_databricks\": \"dapi_dev456\",\n  \"staging_snowflake\": \"sf_stg789\",\n  \"prod_snowflake\": \"sf_prd012\"\n}'\n</code></pre> <p>Token Security</p> <ul> <li>Never commit actual tokens to Git</li> <li>Use environment-specific tokens (dev, staging, prod)</li> <li>Rotate tokens periodically</li> <li>Use service principals, not personal tokens</li> </ul>"},{"location":"configuration/environment-variables/#finding-your-dbt-cloud-values","title":"Finding Your dbt Cloud Values","text":""},{"location":"configuration/environment-variables/#account-id","title":"Account ID","text":"<ol> <li>Log into dbt Cloud</li> <li>Look at the URL: <code>https://cloud.getdbt.com/accounts/{account_id}/</code></li> <li>The number after <code>/accounts/</code> is your account ID</li> </ol>"},{"location":"configuration/environment-variables/#api-token-pat","title":"API Token &amp; PAT","text":"<ol> <li>Go to https://cloud.getdbt.com/settings/profile</li> <li>Scroll to \"API Access\"</li> <li>Click \"Create Token\" or \"Create Service Account Token\"</li> <li>Copy the token (starts with <code>dbtc_</code>)</li> </ol> <p>Token vs PAT</p> <p>For this module, use the same token for both <code>dbt_api_token</code> and <code>dbt_pat</code>.</p>"},{"location":"configuration/environment-variables/#host-url","title":"Host URL","text":"Region Host URL US (Multi-tenant) <code>https://cloud.getdbt.com/api</code> EMEA (Multi-tenant) <code>https://emea.dbt.com/api</code> AU (Multi-tenant) <code>https://au.dbt.com/api</code> Single-tenant <code>https://{your-account}.getdbt.com/api</code>"},{"location":"configuration/environment-variables/#connection-ids","title":"Connection IDs","text":"<ol> <li>In dbt Cloud: Admin &gt; Connections</li> <li>Click on your connection</li> <li>Look at the URL: <code>/connections/{connection_id}</code></li> <li>Or check the connection details page</li> </ol>"},{"location":"configuration/environment-variables/#best-practices","title":"Best Practices","text":""},{"location":"configuration/environment-variables/#security","title":"Security","text":"<p>\u2705 DO: - Use <code>.env</code> for local development - Use CI/CD secrets for automation - Add <code>.env</code> and <code>terraform.tfvars</code> to <code>.gitignore</code> - Use service account tokens, not personal tokens - Rotate credentials regularly - Use different tokens for dev/staging/prod</p> <p>\u274c DON'T: - Commit credentials to Git - Share tokens in chat/email - Use production tokens in development - Hardcode credentials in <code>.tf</code> files</p>"},{"location":"configuration/environment-variables/#organization","title":"Organization","text":"<pre><code>my-dbt-project/\n\u251c\u2500\u2500 .env                  # Local credentials (gitignored)\n\u251c\u2500\u2500 .env.example          # Template (committed)\n\u251c\u2500\u2500 .gitignore            # Includes .env, *.tfvars\n\u251c\u2500\u2500 main.tf               # No credentials here!\n\u251c\u2500\u2500 variables.tf          # Variable definitions only\n\u251c\u2500\u2500 dbt-config.yml        # References token_map keys\n\u2514\u2500\u2500 configs/              # Multiple project configs\n    \u251c\u2500\u2500 finance.yml\n    \u251c\u2500\u2500 marketing.yml\n    \u2514\u2500\u2500 operations.yml\n</code></pre>"},{"location":"configuration/environment-variables/#debugging","title":"Debugging","text":"<p>Check if variables are loaded:</p> <pre><code># After source .env\nenv | grep TF_VAR\n\n# Or for a specific variable\necho $TF_VAR_dbt_account_id\n</code></pre>"},{"location":"configuration/environment-variables/#troubleshooting","title":"Troubleshooting","text":""},{"location":"configuration/environment-variables/#error-no-value-for-required-variable","title":"\"Error: No value for required variable\"","text":"<p>Problem: Terraform can't find the variable.</p> <p>Solutions: <pre><code># Make sure to source .env\nsource .env\n\n# Verify it's set\necho $TF_VAR_dbt_account_id\n\n# Or pass directly\nterraform plan -var=\"dbt_account_id=12345\"\n</code></pre></p>"},{"location":"configuration/environment-variables/#invalid-json-for-token_map","title":"\"Invalid JSON for token_map\"","text":"<p>Problem: <code>token_map</code> isn't valid JSON.</p> <p>Solutions: <pre><code># \u274c Multi-line won't work\nexport TF_VAR_token_map='{\n  \"key\": \"value\"\n}'\n\n# \u2705 Single line\nexport TF_VAR_token_map='{\"key\":\"value\"}'\n\n# \u2705 Or use terraform.tfvars\ntoken_map = {\n  key = \"value\"\n}\n</code></pre></p>"},{"location":"configuration/environment-variables/#401-unauthorized-from-dbt-cloud","title":"\"401 Unauthorized\" from dbt Cloud","text":"<p>Problem: Invalid or expired API token.</p> <p>Solutions: - Regenerate token in dbt Cloud settings - Verify token starts with <code>dbtc_</code> - Check you're using the right account - Ensure token has necessary permissions</p>"},{"location":"configuration/environment-variables/#next-steps","title":"Next Steps","text":"<ul> <li> <p>:material-file-yaml:{ .lg .middle } YAML Schema</p> <p>Configure your dbt projects</p> <p> YAML Schema</p> </li> <li> <p>:material-github-box:{ .lg .middle } CI/CD Guide</p> <p>Automate deployments</p> <p> CI/CD Integration</p> </li> <li> <p> Troubleshooting</p> <p>Common issues and solutions</p> <p> Troubleshooting</p> </li> </ul>"},{"location":"configuration/multi-project/","title":"Multi-Project Setup","text":"<p>Learn how to manage multiple dbt Cloud projects with a single Terraform configuration.</p>"},{"location":"configuration/multi-project/#overview","title":"Overview","text":"<p>This module supports managing multiple dbt projects efficiently:</p> <ul> <li>Sequential deployment: Deploy projects one at a time</li> <li>Parallel deployment: Deploy multiple projects simultaneously in CI/CD</li> <li>Shared configuration: Reuse Terraform code across projects</li> <li>Independent state: Each project can have its own state file</li> </ul>"},{"location":"configuration/multi-project/#architecture-patterns","title":"Architecture Patterns","text":""},{"location":"configuration/multi-project/#pattern-1-single-directory-multiple-configs","title":"Pattern 1: Single Directory, Multiple Configs","text":"<p>Best for: Small teams, similar projects</p> <pre><code>terraform/\n\u251c\u2500\u2500 main.tf\n\u251c\u2500\u2500 variables.tf\n\u251c\u2500\u2500 .env\n\u2514\u2500\u2500 configs/\n    \u251c\u2500\u2500 finance.yml\n    \u251c\u2500\u2500 marketing.yml\n    \u2514\u2500\u2500 operations.yml\n</code></pre> <p>Deploy specific project:</p> <pre><code>source .env\nterraform apply -var=\"yaml_file_path=./configs/finance.yml\"\n</code></pre>"},{"location":"configuration/multi-project/#pattern-2-separate-directories-recommended","title":"Pattern 2: Separate Directories (Recommended)","text":"<p>Best for: Large teams, different requirements, independent state</p> <pre><code>dbt-infrastructure/\n\u251c\u2500\u2500 finance/\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u251c\u2500\u2500 .env\n\u2502   \u2514\u2500\u2500 dbt-config.yml\n\u251c\u2500\u2500 marketing/\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u251c\u2500\u2500 .env\n\u2502   \u2514\u2500\u2500 dbt-config.yml\n\u2514\u2500\u2500 operations/\n    \u251c\u2500\u2500 main.tf\n    \u251c\u2500\u2500 variables.tf\n    \u251c\u2500\u2500 .env\n    \u2514\u2500\u2500 dbt-config.yml\n</code></pre> <p>Each directory has independent Terraform state.</p>"},{"location":"configuration/multi-project/#pattern-3-workspaces","title":"Pattern 3: Workspaces","text":"<p>Best for: Same configuration, different values</p> <pre><code>terraform/\n\u251c\u2500\u2500 main.tf\n\u251c\u2500\u2500 variables.tf\n\u2514\u2500\u2500 configs/\n    \u251c\u2500\u2500 dev.yml\n    \u251c\u2500\u2500 staging.yml\n    \u2514\u2500\u2500 prod.yml\n</code></pre> <p>Use Terraform workspaces:</p> <pre><code>terraform workspace new finance\nterraform workspace select finance\nterraform apply -var=\"yaml_file_path=./configs/finance.yml\"\n</code></pre>"},{"location":"configuration/multi-project/#sequential-deployment","title":"Sequential Deployment","text":"<p>Deploy multiple projects one at a time.</p>"},{"location":"configuration/multi-project/#bash-script","title":"Bash Script","text":"deploy-all.sh<pre><code>#!/bin/bash\n\n# Load credentials\nsource .env\n\n# Deploy each project\nfor config in configs/*.yml; do\n  project_name=$(basename $config .yml)\n  echo \"Deploying $project_name...\"\n\n  terraform apply \\\n    -var=\"yaml_file_path=$config\" \\\n    -auto-approve\n\n  if [ $? -eq 0 ]; then\n    echo \"\u2705 $project_name deployed successfully\"\n  else\n    echo \"\u274c $project_name deployment failed\"\n    exit 1\n  fi\ndone\n\necho \"\ud83c\udf89 All projects deployed!\"\n</code></pre> <p>Run it:</p> <pre><code>chmod +x deploy-all.sh\n./deploy-all.sh\n</code></pre>"},{"location":"configuration/multi-project/#parallel-deployment","title":"Parallel Deployment","text":"<p>Deploy multiple projects simultaneously using CI/CD matrix builds.</p>"},{"location":"configuration/multi-project/#github-actions","title":"GitHub Actions","text":".github/workflows/deploy-multi.yml<pre><code>name: Deploy Multiple Projects\n\non:\n  push:\n    branches: [main]\n    paths:\n      - 'configs/**.yml'\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        project:\n          - finance\n          - marketing\n          - operations\n      fail-fast: false  # Continue even if one fails\n\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n        with:\n          terraform_version: 1.6.0\n\n      - name: Terraform Init\n        run: terraform init\n\n      - name: Deploy ${{ matrix.project }}\n        env:\n          TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n          TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n          TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n          TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n          TF_VAR_yaml_file_path: ./configs/${{ matrix.project }}.yml\n          TF_VAR_token_map: ${{ secrets.TOKEN_MAP }}\n        run: |\n          terraform plan -out=tfplan\n          terraform apply tfplan\n</code></pre>"},{"location":"configuration/multi-project/#gitlab-cicd","title":"GitLab CI/CD","text":".gitlab-ci.yml<pre><code>stages:\n  - deploy\n\n.deploy-template:\n  image: hashicorp/terraform:latest\n  stage: deploy\n  variables:\n    TF_VAR_dbt_account_id: $DBT_ACCOUNT_ID\n    TF_VAR_dbt_api_token: $DBT_API_TOKEN\n    TF_VAR_dbt_pat: $DBT_PAT\n    TF_VAR_dbt_host_url: \"https://cloud.getdbt.com/api\"\n    TF_VAR_token_map: $TOKEN_MAP\n  script:\n    - terraform init\n    - terraform plan -out=tfplan\n    - terraform apply tfplan\n  only:\n    - main\n\ndeploy-finance:\n  extends: .deploy-template\n  variables:\n    TF_VAR_yaml_file_path: \"./configs/finance.yml\"\n\ndeploy-marketing:\n  extends: .deploy-template\n  variables:\n    TF_VAR_yaml_file_path: \"./configs/marketing.yml\"\n\ndeploy-operations:\n  extends: .deploy-template\n  variables:\n    TF_VAR_yaml_file_path: \"./configs/operations.yml\"\n</code></pre>"},{"location":"configuration/multi-project/#shared-vs-independent-state","title":"Shared vs Independent State","text":""},{"location":"configuration/multi-project/#shared-state-not-recommended","title":"Shared State (Not Recommended)","text":"<p>All projects share one <code>terraform.tfstate</code>.</p> <p>Pros: - Simple setup - One backend configuration</p> <p>Cons: - \u26a0\ufe0f All projects must be deployed together - \u26a0\ufe0f State conflicts if deployed in parallel - \u26a0\ufe0f One failure affects all projects - \u26a0\ufe0f Slower plan/apply for large projects</p>"},{"location":"configuration/multi-project/#independent-state-recommended","title":"Independent State (Recommended)","text":"<p>Each project has its own state.</p> <p>Pros: - \u2705 Deploy independently - \u2705 Parallel deployments - \u2705 Isolated failures - \u2705 Faster operations</p> <p>Cons: - More backend configurations</p>"},{"location":"configuration/multi-project/#implementation","title":"Implementation","text":"<p>Option 1: Separate Directories</p> <pre><code>projects/\n\u251c\u2500\u2500 finance/\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2514\u2500\u2500 backend.tf  # Different key\n\u251c\u2500\u2500 marketing/\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u2514\u2500\u2500 backend.tf  # Different key\n</code></pre> finance/backend.tf<pre><code>terraform {\n  backend \"s3\" {\n    bucket = \"my-terraform-state\"\n    key    = \"dbt-cloud/finance/terraform.tfstate\"\n    region = \"us-east-1\"\n  }\n}\n</code></pre> <p>Option 2: Workspaces</p> <pre><code>terraform workspace new finance\nterraform workspace new marketing\nterraform workspace new operations\n</code></pre>"},{"location":"configuration/multi-project/#best-practices","title":"Best Practices","text":""},{"location":"configuration/multi-project/#1-naming-conventions","title":"1. Naming Conventions","text":"<p>Use consistent naming across projects:</p> <pre><code># finance.yml\nproject:\n  name: \"finance-analytics\"\n\n# marketing.yml  \nproject:\n  name: \"marketing-analytics\"\n\n# operations.yml\nproject:\n  name: \"operations-analytics\"\n</code></pre>"},{"location":"configuration/multi-project/#2-shared-variables","title":"2. Shared Variables","text":"<p>Extract common configuration:</p> common-variables.tf<pre><code>variable \"dbt_account_id\" {\n  type = number\n}\n\nvariable \"common_tags\" {\n  type = map(string)\n  default = {\n    managed_by = \"terraform\"\n    team       = \"data\"\n  }\n}\n</code></pre>"},{"location":"configuration/multi-project/#3-credential-management","title":"3. Credential Management","text":"<p>Use project-specific tokens in <code>token_map</code>:</p> <pre><code>export TF_VAR_token_map='{\n  \"finance_prod_db\": \"token1\",\n  \"finance_dev_db\": \"token2\",\n  \"marketing_prod_db\": \"token3\",\n  \"marketing_dev_db\": \"token4\"\n}'\n</code></pre>"},{"location":"configuration/multi-project/#4-cicd-triggers","title":"4. CI/CD Triggers","text":"<p>Deploy only when relevant configs change:</p> <pre><code>on:\n  push:\n    paths:\n      - 'configs/finance.yml'  # Only finance project\n</code></pre>"},{"location":"configuration/multi-project/#5-error-handling","title":"5. Error Handling","text":"<p>Use <code>fail-fast: false</code> in matrix jobs to continue on failures:</p> <pre><code>strategy:\n  matrix:\n    project: [finance, marketing, operations]\n  fail-fast: false\n</code></pre>"},{"location":"configuration/multi-project/#example-complete-multi-project-setup","title":"Example: Complete Multi-Project Setup","text":""},{"location":"configuration/multi-project/#directory-structure","title":"Directory Structure","text":"<pre><code>dbt-projects/\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u2514\u2500\u2500 deploy.yml\n\u251c\u2500\u2500 terraform/\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u251c\u2500\u2500 backend.tf\n\u2502   \u2514\u2500\u2500 .env.example\n\u251c\u2500\u2500 configs/\n\u2502   \u251c\u2500\u2500 finance.yml\n\u2502   \u251c\u2500\u2500 marketing.yml\n\u2502   \u2514\u2500\u2500 operations.yml\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"configuration/multi-project/#main-configuration","title":"Main Configuration","text":"terraform/main.tf<pre><code>terraform {\n  required_version = \"&gt;= 1.0\"\n  required_providers {\n    dbtcloud = {\n      source  = \"dbt-labs/dbtcloud\"\n      version = \"~&gt; 1.3\"\n    }\n  }\n\n  backend \"s3\" {\n    bucket = \"my-company-terraform-state\"\n    key    = \"dbt-cloud/${var.project_name}/terraform.tfstate\"\n    region = \"us-east-1\"\n  }\n}\n\nprovider \"dbtcloud\" {\n  account_id = var.dbt_account_id\n  token      = var.dbt_api_token\n  host_url   = var.dbt_host_url\n}\n\nmodule \"dbt_cloud\" {\n  source = \"git::https://github.com/trouze/dbt-terraform-modules-yaml.git\"\n\n  dbt_account_id = var.dbt_account_id\n  dbt_token      = var.dbt_api_token\n  dbt_pat        = var.dbt_pat\n  dbt_host_url   = var.dbt_host_url\n  yaml_file      = var.yaml_file_path\n  token_map      = var.token_map\n  target_name    = var.target_name\n}\n</code></pre>"},{"location":"configuration/multi-project/#github-actions-workflow","title":"GitHub Actions Workflow","text":".github/workflows/deploy.yml<pre><code>name: Deploy dbt Projects\n\non:\n  push:\n    branches: [main]\n    paths:\n      - 'configs/**.yml'\n      - 'terraform/**.tf'\n\njobs:\n  detect-changes:\n    runs-on: ubuntu-latest\n    outputs:\n      projects: ${{ steps.filter.outputs.changes }}\n    steps:\n      - uses: actions/checkout@v3\n\n      - uses: dorny/paths-filter@v2\n        id: filter\n        with:\n          filters: |\n            finance:\n              - 'configs/finance.yml'\n            marketing:\n              - 'configs/marketing.yml'\n            operations:\n              - 'configs/operations.yml'\n\n  deploy:\n    needs: detect-changes\n    if: ${{ needs.detect-changes.outputs.projects != '[]' }}\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        project: ${{ fromJSON(needs.detect-changes.outputs.projects) }}\n      fail-fast: false\n\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n\n      - name: Terraform Init\n        working-directory: terraform\n        run: terraform init\n\n      - name: Deploy ${{ matrix.project }}\n        working-directory: terraform\n        env:\n          TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n          TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n          TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n          TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n          TF_VAR_yaml_file_path: ../configs/${{ matrix.project }}.yml\n          TF_VAR_token_map: ${{ secrets.TOKEN_MAP_${{ matrix.project | upper }} }}\n        run: |\n          terraform workspace select -or-create ${{ matrix.project }}\n          terraform plan -out=tfplan\n          terraform apply tfplan\n</code></pre>"},{"location":"configuration/multi-project/#monitoring-reporting","title":"Monitoring &amp; Reporting","text":""},{"location":"configuration/multi-project/#terraform-cloud","title":"Terraform Cloud","text":"<p>Use Terraform Cloud for visibility across projects:</p> backend.tf<pre><code>terraform {\n  cloud {\n    organization = \"my-company\"\n\n    workspaces {\n      tags = [\"dbt-cloud\", \"production\"]\n    }\n  }\n}\n</code></pre>"},{"location":"configuration/multi-project/#custom-reporting","title":"Custom Reporting","text":"<p>Track deployments across projects:</p> report-status.sh<pre><code>#!/bin/bash\n\necho \"dbt Cloud Project Status\"\necho \"========================\"\n\nfor config in configs/*.yml; do\n  project=$(basename $config .yml)\n  workspace=$(terraform workspace show 2&gt;/dev/null || echo \"default\")\n\n  if terraform show -json | jq -e '.values' &gt; /dev/null 2&gt;&amp;1; then\n    status=\"\u2705 Deployed\"\n  else\n    status=\"\u274c Not deployed\"\n  fi\n\n  echo \"$project: $status (workspace: $workspace)\"\ndone\n</code></pre>"},{"location":"configuration/multi-project/#troubleshooting","title":"Troubleshooting","text":""},{"location":"configuration/multi-project/#issue-state-lock-errors","title":"Issue: State Lock Errors","text":"<p>Problem: Multiple parallel deploys trying to modify same state.</p> <p>Solution: Use independent state files or workspaces.</p>"},{"location":"configuration/multi-project/#issue-credential-confusion","title":"Issue: Credential Confusion","text":"<p>Problem: Wrong database tokens used for projects.</p> <p>Solution: Use project-specific environment variable suffixes:</p> <pre><code>export TF_VAR_token_map_finance='{\"key\":\"value\"}'\nexport TF_VAR_token_map_marketing='{\"key\":\"value\"}'\n</code></pre>"},{"location":"configuration/multi-project/#issue-slow-deployments","title":"Issue: Slow Deployments","text":"<p>Problem: Sequential deployment takes too long.</p> <p>Solution: Use parallel CI/CD matrix builds.</p>"},{"location":"configuration/multi-project/#next-steps","title":"Next Steps","text":"<ul> <li> <p>:material-github-box:{ .lg .middle } CI/CD Integration</p> <p>Automate multi-project deployments</p> <p> CI/CD Guide</p> </li> <li> <p> Best Practices</p> <p>Organize your infrastructure</p> <p> Best Practices</p> </li> </ul>"},{"location":"configuration/yaml-schema/","title":"YAML Schema Reference","text":"<p>Complete reference for the dbt Cloud YAML configuration format.</p>"},{"location":"configuration/yaml-schema/#schema-overview","title":"Schema Overview","text":"<p>The YAML configuration is validated against a JSON Schema to ensure correctness. Your IDE can use this schema for auto-completion and validation.</p>"},{"location":"configuration/yaml-schema/#ide-setup","title":"IDE Setup","text":"<p>Add this to the top of your <code>dbt-config.yml</code>:</p> <pre><code># yaml-language-server: $schema=https://raw.githubusercontent.com/trouze/dbt-terraform-modules-yaml/main/schemas/v1.json\n\nproject:\n  name: \"my-project\"\n  ...\n</code></pre> <p>VS Code Users</p> <p>Install the YAML extension by Red Hat for auto-completion and validation.</p>"},{"location":"configuration/yaml-schema/#root-structure","title":"Root Structure","text":"<pre><code>project:              # Required: Root configuration object\n  name: &lt;string&gt;      # Required: Project name\n  repository:         # Required: Git repository configuration\n    ...\n  environments:       # Required: List of environments\n    - ...\n  environment_variables:  # Optional: Project-level env vars\n    - ...\n</code></pre>"},{"location":"configuration/yaml-schema/#project-configuration","title":"Project Configuration","text":""},{"location":"configuration/yaml-schema/#projectname","title":"<code>project.name</code>","text":"<p>Type: <code>string</code> (required)</p> <p>Description: Name of your dbt Cloud project.</p> <p>Constraints: - Must be alphanumeric with underscores or hyphens - 1-128 characters - Pattern: <code>^[a-zA-Z0-9_-]+$</code></p> <p>Examples:</p> <pre><code>project:\n  name: \"analytics\"           # \u2705 Valid\n  name: \"finance-reporting\"   # \u2705 Valid\n  name: \"data_warehouse_2\"    # \u2705 Valid\n  name: \"Finance Analytics!\"  # \u274c Invalid (special char)\n  name: \"\"                    # \u274c Invalid (empty)\n</code></pre>"},{"location":"configuration/yaml-schema/#repository-configuration","title":"Repository Configuration","text":""},{"location":"configuration/yaml-schema/#projectrepository","title":"<code>project.repository</code>","text":"<p>Type: <code>object</code> (required)</p> <p>Configure Git integration for your dbt project.</p>"},{"location":"configuration/yaml-schema/#fields","title":"Fields","text":""},{"location":"configuration/yaml-schema/#remote_url","title":"<code>remote_url</code>","text":"<p>Type: <code>string</code> (required)</p> <p>Description: Git repository URL (HTTPS or SSH format).</p> <p>Supported Providers: - GitHub: <code>https://github.com/org/repo.git</code> or <code>git@github.com:org/repo.git</code> - GitLab: <code>https://gitlab.com/group/repo.git</code> or <code>git@gitlab.com:group/repo.git</code> - Azure DevOps: <code>https://dev.azure.com/org/project/_git/repo</code> - Bitbucket: <code>https://bitbucket.org/user/repo.git</code></p> <p>Examples:</p> <pre><code>repository:\n  remote_url: \"https://github.com/myorg/dbt-analytics.git\"   # GitHub HTTPS\n  remote_url: \"git@github.com:myorg/dbt-analytics.git\"       # GitHub SSH\n  remote_url: \"https://gitlab.com/myorg/data/dbt.git\"        # GitLab\n  remote_url: \"https://dev.azure.com/myorg/data/_git/dbt\"    # Azure DevOps\n</code></pre>"},{"location":"configuration/yaml-schema/#git_clone_strategy","title":"<code>git_clone_strategy</code>","text":"<p>Type: <code>string</code> (optional)</p> <p>Description: How dbt Cloud authenticates with your Git provider.</p> <p>Options: - <code>deploy_key</code> (default) - SSH deploy key (universal, works with all providers) - <code>github_app</code> - GitHub App integration (GitHub only, recommended) - <code>deploy_token</code> - GitLab deploy token (GitLab only, recommended) - <code>azure_active_directory_app</code> - Azure AD App (Azure DevOps only)</p> <p>Auto-Detection: If omitted, defaults to <code>deploy_key</code> for all providers.</p> <p>Examples:</p> <pre><code># GitHub with GitHub App (recommended for GitHub)\nrepository:\n  remote_url: \"https://github.com/myorg/repo.git\"\n  git_clone_strategy: \"github_app\"\n  github_installation_id: 12345678\n\n# GitLab with Deploy Token (recommended for GitLab)\nrepository:\n  remote_url: \"https://gitlab.com/myorg/repo.git\"\n  git_clone_strategy: \"deploy_token\"\n  gitlab_project_id: 9876543\n\n# Universal SSH Deploy Key (works everywhere)\nrepository:\n  remote_url: \"git@github.com:myorg/repo.git\"\n  git_clone_strategy: \"deploy_key\"\n</code></pre>"},{"location":"configuration/yaml-schema/#provider-specific-fields","title":"Provider-Specific Fields","text":"<p>GitHub:</p> <ul> <li><code>github_installation_id</code> (integer, required with <code>github_app</code>)</li> <li>Your GitHub App installation ID</li> <li>Find in: GitHub Settings &gt; Applications &gt; dbt Cloud</li> </ul> <p>GitLab:</p> <ul> <li><code>gitlab_project_id</code> (integer, required with <code>deploy_token</code>)</li> <li>Numeric project ID</li> <li>Find in: GitLab Project &gt; Settings &gt; General</li> </ul> <p>Azure DevOps:</p> <ul> <li><code>azure_active_directory_project_id</code> (string, required with <code>azure_active_directory_app</code>)</li> <li>Project UUID</li> <li><code>azure_active_directory_repository_id</code> (string, required with <code>azure_active_directory_app</code>)</li> <li>Repository UUID</li> <li><code>azure_bypass_webhook_registration_failure</code> (boolean, optional)</li> <li>Set <code>true</code> if user can't register webhooks</li> <li>Default: <code>false</code></li> </ul>"},{"location":"configuration/yaml-schema/#other-fields","title":"Other Fields","text":"<ul> <li><code>is_active</code> (boolean, optional) - Default: <code>true</code></li> <li><code>private_link_endpoint_id</code> (string, optional) - For VPC/Private Link</li> <li><code>pull_request_url_template</code> (string, optional) - Custom PR URL template</li> </ul>"},{"location":"configuration/yaml-schema/#environment-configuration","title":"Environment Configuration","text":""},{"location":"configuration/yaml-schema/#projectenvironments","title":"<code>project.environments</code>","text":"<p>Type: <code>array</code> (required, min 1 item)</p> <p>Define your dbt Cloud environments (dev, staging, prod, etc.).</p>"},{"location":"configuration/yaml-schema/#environment-object","title":"Environment Object","text":"<pre><code>environments:\n  - name: &lt;string&gt;              # Required\n    type: &lt;string&gt;              # Required: \"development\" or \"deployment\"\n    connection_id: &lt;integer&gt;    # Required\n    credential:                 # Required\n      token_name: &lt;string&gt;      # Required\n      schema: &lt;string&gt;          # Required\n      catalog: &lt;string&gt;         # Optional\n    dbt_version: &lt;string&gt;       # Optional\n    custom_branch: &lt;string&gt;     # Optional\n    enable_model_query_history: &lt;boolean&gt;  # Optional\n    jobs:                       # Optional\n      - ...\n</code></pre>"},{"location":"configuration/yaml-schema/#fields_1","title":"Fields","text":""},{"location":"configuration/yaml-schema/#name","title":"<code>name</code>","text":"<p>Type: <code>string</code> (required)</p> <p>Environment name (e.g., \"Production\", \"Development\", \"Staging\").</p>"},{"location":"configuration/yaml-schema/#type","title":"<code>type</code>","text":"<p>Type: <code>string</code> (required)</p> <p>Options: - <code>development</code> - For development work - <code>deployment</code> - For production/staging deployments</p>"},{"location":"configuration/yaml-schema/#connection_id","title":"<code>connection_id</code>","text":"<p>Type: <code>integer</code> (required)</p> <p>dbt Cloud connection ID for your data warehouse.</p> <p>Where to find this</p> <p>In dbt Cloud: Admin &gt; Connections &gt; Copy the connection ID</p>"},{"location":"configuration/yaml-schema/#credential","title":"<code>credential</code>","text":"<p>Type: <code>object</code> (required)</p> <p>Database credentials for this environment.</p> <p>Fields: - <code>token_name</code> (string, required) - Key in <code>token_map</code> variable containing the database token - <code>schema</code> (string, required) - Default schema/dataset name - <code>catalog</code> (string, optional) - Catalog name (for Unity Catalog, etc.)</p> <p>Example:</p> <pre><code>credential:\n  token_name: \"prod_databricks_token\"  # References token_map[\"prod_databricks_token\"]\n  schema: \"analytics_prod\"\n  catalog: \"production\"  # Optional: for Databricks Unity Catalog\n</code></pre>"},{"location":"configuration/yaml-schema/#dbt_version","title":"<code>dbt_version</code>","text":"<p>Type: <code>string</code> (optional)</p> <p>dbt version to use (e.g., <code>\"1.6.0\"</code>, <code>\"1.7.1\"</code>). Defaults to latest.</p>"},{"location":"configuration/yaml-schema/#custom_branch","title":"<code>custom_branch</code>","text":"<p>Type: <code>string</code> (optional)</p> <p>Git branch to use for this environment. Defaults to repository default branch.</p> <p>Example:</p> <pre><code>- name: \"Staging\"\n  custom_branch: \"staging\"  # Use staging branch instead of main\n</code></pre>"},{"location":"configuration/yaml-schema/#jobs-configuration","title":"Jobs Configuration","text":""},{"location":"configuration/yaml-schema/#environmentsjobs","title":"<code>environments[].jobs</code>","text":"<p>Type: <code>array</code> (optional)</p> <p>Define dbt jobs that run in this environment.</p>"},{"location":"configuration/yaml-schema/#job-object","title":"Job Object","text":"<pre><code>jobs:\n  - name: &lt;string&gt;              # Required\n    description: &lt;string&gt;       # Optional\n    is_active: &lt;boolean&gt;        # Optional, default: true\n    execute_steps:              # Required\n      - &lt;string&gt;\n    triggers:                   # Required\n      schedule: &lt;boolean&gt;\n      github_webhook: &lt;boolean&gt;\n      git_provider_webhook: &lt;boolean&gt;\n      on_merge: &lt;boolean&gt;\n    # Scheduling\n    schedule_type: &lt;string&gt;     # Optional: \"every_day\", \"every_week\", \"every_month\"\n    schedule_hours: [&lt;int&gt;]     # Optional: Hours (0-23, UTC)\n    schedule_days: [&lt;int&gt;]      # Optional: Days (0=Sun, 6=Sat)\n    schedule_cron: &lt;string&gt;     # Optional: Custom cron expression\n    # Execution\n    num_threads: &lt;int&gt;          # Optional: 1-16, default: 4\n    timeout_seconds: &lt;int&gt;      # Optional: 300-86400\n    target_name: &lt;string&gt;       # Optional: dbt target name\n    dbt_version: &lt;string&gt;       # Optional: Job-specific dbt version\n    # Features\n    generate_docs: &lt;boolean&gt;    # Optional: Generate docs\n    run_lint: &lt;boolean&gt;         # Optional: Run linters\n    run_generate_sources: &lt;boolean&gt;  # Optional: Source freshness\n    # Deferral\n    deferring_environment: &lt;string&gt;  # Optional: Defer to environment name\n</code></pre>"},{"location":"configuration/yaml-schema/#examples","title":"Examples","text":""},{"location":"configuration/yaml-schema/#simple-daily-job","title":"Simple Daily Job","text":"<pre><code>jobs:\n  - name: \"Daily Production Run\"\n    execute_steps:\n      - \"dbt run\"\n      - \"dbt test\"\n    triggers:\n      schedule: true\n      schedule_hours: [6]  # 6 AM UTC\n      github_webhook: false\n      git_provider_webhook: false\n      on_merge: false\n</code></pre>"},{"location":"configuration/yaml-schema/#ci-job-on-merge","title":"CI Job (On Merge)","text":"<pre><code>jobs:\n  - name: \"Production CI\"\n    description: \"Run on merge to main\"\n    execute_steps:\n      - \"dbt build --select state:modified+\"\n    triggers:\n      schedule: false\n      github_webhook: false\n      git_provider_webhook: false\n      on_merge: true\n    deferring_environment: \"Production\"  # Defer to prod for state comparison\n</code></pre>"},{"location":"configuration/yaml-schema/#advanced-scheduled-job","title":"Advanced Scheduled Job","text":"<pre><code>jobs:\n  - name: \"Weekly Full Refresh\"\n    execute_steps:\n      - \"dbt run --full-refresh\"\n      - \"dbt test\"\n    triggers:\n      schedule: true\n      github_webhook: false\n      git_provider_webhook: false\n      on_merge: false\n    schedule_type: \"every_week\"\n    schedule_days: [0]  # Sunday\n    schedule_hours: [2]  # 2 AM UTC\n    num_threads: 8\n    timeout_seconds: 7200  # 2 hours\n    generate_docs: true\n</code></pre>"},{"location":"configuration/yaml-schema/#environment-variables","title":"Environment Variables","text":""},{"location":"configuration/yaml-schema/#projectenvironment_variables","title":"<code>project.environment_variables</code>","text":"<p>Type: <code>array</code> (optional)</p> <p>Define project-level environment variables accessible to all jobs.</p>"},{"location":"configuration/yaml-schema/#environment-variable-object","title":"Environment Variable Object","text":"<pre><code>environment_variables:\n  - name: &lt;string&gt;              # Required: Must use UPPER_SNAKE_CASE\n    environment_values:         # Required: Values by environment name\n      &lt;environment_name&gt;: &lt;string&gt;\n</code></pre>"},{"location":"configuration/yaml-schema/#examples_1","title":"Examples","text":"<pre><code>environment_variables:\n  - name: \"DBT_WAREHOUSE_NAME\"\n    environment_values:\n      Development: \"dev_warehouse\"\n      Staging: \"staging_warehouse\"\n      Production: \"prod_warehouse\"\n\n  - name: \"DBT_MAX_RETRIES\"\n    environment_values:\n      Development: \"1\"\n      Production: \"3\"\n</code></pre>"},{"location":"configuration/yaml-schema/#complete-example","title":"Complete Example","text":"<p>Here's a full example combining all elements:</p> <pre><code># yaml-language-server: $schema=https://raw.githubusercontent.com/trouze/dbt-terraform-modules-yaml/main/schemas/v1.json\n\nproject:\n  name: \"analytics\"\n\n  repository:\n    remote_url: \"https://github.com/myorg/dbt-analytics.git\"\n    git_clone_strategy: \"github_app\"\n    github_installation_id: 12345678\n\n  environments:\n    - name: \"Development\"\n      type: \"development\"\n      connection_id: 1001\n      credential:\n        token_name: \"dev_snowflake_token\"\n        schema: \"dev_analytics\"\n      custom_branch: \"develop\"\n      enable_model_query_history: true\n\n    - name: \"Production\"\n      type: \"deployment\"\n      connection_id: 1002\n      credential:\n        token_name: \"prod_snowflake_token\"\n        schema: \"analytics\"\n      dbt_version: \"1.7.1\"\n      jobs:\n        - name: \"Daily Run\"\n          execute_steps:\n            - \"dbt run\"\n            - \"dbt test\"\n          triggers:\n            schedule: true\n            schedule_hours: [6]\n            github_webhook: false\n            git_provider_webhook: false\n            on_merge: false\n          num_threads: 8\n          generate_docs: true\n\n        - name: \"CI Check\"\n          execute_steps:\n            - \"dbt build --select state:modified+\"\n          triggers:\n            schedule: false\n            github_webhook: false\n            git_provider_webhook: false\n            on_merge: true\n          deferring_environment: \"Production\"\n\n  environment_variables:\n    - name: \"DBT_CLOUD_ENV\"\n      environment_values:\n        Development: \"dev\"\n        Production: \"prod\"\n</code></pre>"},{"location":"configuration/yaml-schema/#validation","title":"Validation","text":"<p>The module validates your YAML against the schema during <code>terraform plan</code>. Common errors:</p> <ul> <li>Missing required fields: Add the required field</li> <li>Invalid enum value: Check allowed values in this reference</li> <li>Type mismatch: Ensure strings are quoted, numbers are not</li> <li>Pattern mismatch: Check format constraints (e.g., project name pattern)</li> </ul> <p>For IDE validation, add the schema URL to your YAML file header as shown above.</p>"},{"location":"getting-started/examples/","title":"Examples","text":"<p>Explore real-world examples and use cases for managing dbt Cloud with Terraform.</p>"},{"location":"getting-started/examples/#basic-example","title":"Basic Example","text":"<p>The simplest possible setup to get started.</p>"},{"location":"getting-started/examples/#what-it-includes","title":"What It Includes","text":"<ul> <li>Single dbt Cloud project</li> <li>GitHub repository integration</li> <li>One production environment</li> <li>One scheduled job</li> </ul>"},{"location":"getting-started/examples/#directory-structure","title":"Directory Structure","text":"<pre><code>examples/basic/\n\u251c\u2500\u2500 main.tf              # Terraform module call\n\u251c\u2500\u2500 variables.tf         # Input variables\n\u251c\u2500\u2500 dbt-config.yml      # dbt Cloud configuration\n\u2514\u2500\u2500 .env.example        # Credential template\n</code></pre>"},{"location":"getting-started/examples/#try-it-out","title":"Try It Out","text":"<pre><code>cd examples/basic\ncp .env.example .env\n# Edit .env with your credentials\nsource .env\nterraform init\nterraform plan\nterraform apply\n</code></pre> <p> View Source</p>"},{"location":"getting-started/examples/#managing-multiple-projects","title":"Managing Multiple Projects","text":"<p>Store multiple YAML configurations and manage them independently or in parallel.</p>"},{"location":"getting-started/examples/#scenario-multiple-teams","title":"Scenario: Multiple Teams","text":"<p>You have separate dbt projects for different teams (Finance, Marketing, Operations) and want to manage them with the same Terraform workflow.</p>"},{"location":"getting-started/examples/#directory-structure_1","title":"Directory Structure","text":"<pre><code>my-dbt-infrastructure/\n\u251c\u2500\u2500 main.tf\n\u251c\u2500\u2500 variables.tf\n\u251c\u2500\u2500 .env\n\u2514\u2500\u2500 configs/\n    \u251c\u2500\u2500 finance.yml\n    \u251c\u2500\u2500 marketing.yml\n    \u2514\u2500\u2500 operations.yml\n</code></pre>"},{"location":"getting-started/examples/#deploy-specific-project","title":"Deploy Specific Project","text":"<pre><code># Load credentials once\nsource .env\n\n# Deploy Finance project\nterraform plan -var=\"yaml_file_path=./configs/finance.yml\"\nterraform apply -var=\"yaml_file_path=./configs/finance.yml\"\n\n# Deploy Marketing project\nterraform plan -var=\"yaml_file_path=./configs/marketing.yml\"\nterraform apply -var=\"yaml_file_path=./configs/marketing.yml\"\n</code></pre>"},{"location":"getting-started/examples/#deploy-all-projects-sequential","title":"Deploy All Projects (Sequential)","text":"<pre><code>source .env\n\nfor config in configs/*.yml; do\n  echo \"Deploying $config...\"\n  terraform apply -var=\"yaml_file_path=$config\" -auto-approve\ndone\n</code></pre>"},{"location":"getting-started/examples/#cicd-with-github-actions","title":"CI/CD with GitHub Actions","text":"<p>Automate dbt Cloud infrastructure deployment on configuration changes.</p>"},{"location":"getting-started/examples/#single-project-workflow","title":"Single Project Workflow","text":".github/workflows/dbt-infrastructure.yml<pre><code>name: Deploy dbt Cloud Infrastructure\n\non:\n  push:\n    branches: [main]\n    paths:\n      - 'dbt-config.yml'\n      - '**.tf'\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n        with:\n          terraform_version: 1.6.0\n\n      - name: Terraform Init\n        run: terraform init\n\n      - name: Terraform Plan\n        env:\n          TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n          TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n          TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n          TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n          TF_VAR_yaml_file_path: ./dbt-config.yml\n        run: terraform plan\n\n      - name: Terraform Apply\n        if: github.ref == 'refs/heads/main'\n        env:\n          TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n          TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n          TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n          TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n          TF_VAR_yaml_file_path: ./dbt-config.yml\n        run: terraform apply -auto-approve\n</code></pre>"},{"location":"getting-started/examples/#multi-project-parallel-deployment","title":"Multi-Project Parallel Deployment","text":".github/workflows/multi-project.yml<pre><code>name: Deploy Multiple dbt Projects\n\non:\n  push:\n    branches: [main]\n    paths:\n      - 'configs/**.yml'\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        project: [finance, marketing, operations]\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n\n      - name: Terraform Init\n        run: terraform init\n\n      - name: Deploy ${{ matrix.project }}\n        env:\n          TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n          TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n          TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n          TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n          TF_VAR_yaml_file_path: ./configs/${{ matrix.project }}.yml\n        run: |\n          terraform plan\n          terraform apply -auto-approve\n</code></pre> <p>Required Secrets</p> <p>Add these to your GitHub repository secrets:</p> <ul> <li><code>DBT_ACCOUNT_ID</code></li> <li><code>DBT_API_TOKEN</code></li> <li><code>DBT_PAT</code></li> </ul>"},{"location":"getting-started/examples/#advanced-multi-environment-configuration","title":"Advanced: Multi-Environment Configuration","text":"<p>Manage development, staging, and production environments in one YAML file.</p> dbt-config.yml<pre><code>project:\n  name: \"analytics\"\n  repository:\n    remote_url: \"https://github.com/myorg/dbt-analytics.git\"\n    git_clone_strategy: \"github_app\"\n    github_installation_id: 123456\n\n  environments:\n    # Development environment\n    - name: \"Development\"\n      type: \"development\"\n      connection_id: 1\n      credential:\n        token_name: \"dev_databricks_token\"\n        schema: \"dev\"\n      custom_branch: \"develop\"\n\n    # Staging environment\n    - name: \"Staging\"\n      type: \"deployment\"\n      connection_id: 2\n      credential:\n        token_name: \"staging_databricks_token\"\n        schema: \"staging\"\n      jobs:\n        - name: \"Staging CI\"\n          execute_steps:\n            - \"dbt build\"\n          triggers:\n            on_merge: true\n\n    # Production environment\n    - name: \"Production\"\n      type: \"deployment\"\n      connection_id: 3\n      credential:\n        token_name: \"prod_databricks_token\"\n        schema: \"prod\"\n      jobs:\n        - name: \"Production Daily\"\n          execute_steps:\n            - \"dbt run\"\n            - \"dbt test\"\n          triggers:\n            schedule: true\n            schedule_hours: [6]\n            schedule_days: [0, 1, 2, 3, 4]\n\n        - name: \"Production CI\"\n          execute_steps:\n            - \"dbt build --select state:modified+\"\n          triggers:\n            on_merge: true\n          deferring_environment: \"Production\"\n</code></pre>"},{"location":"getting-started/examples/#complete-yaml-schema-reference","title":"Complete YAML Schema Reference","text":"<p>For the full specification of all available configuration options, see the YAML Schema documentation.</p>"},{"location":"getting-started/examples/#quick-reference","title":"Quick Reference","text":"<pre><code>project:\n  name: &lt;string&gt;                    # Required\n  repository:\n    remote_url: &lt;string&gt;            # Required\n    git_clone_strategy: &lt;string&gt;    # Required\n    gitlab_project_id: &lt;number&gt;     # Optional\n    github_installation_id: &lt;number&gt; # Optional\n\n  environments:\n    - name: &lt;string&gt;                # Required\n      type: &lt;string&gt;                # Required: \"development\" or \"deployment\"\n      connection_id: &lt;number&gt;       # Required\n      credential:\n        token_name: &lt;string&gt;        # Optional\n        schema: &lt;string&gt;            # Optional\n        catalog: &lt;string&gt;           # Optional\n      dbt_version: &lt;string&gt;         # Optional: default \"latest\"\n      custom_branch: &lt;string&gt;       # Optional\n      jobs:\n        - name: &lt;string&gt;            # Required\n          execute_steps:            # Required\n            - &lt;string&gt;\n          triggers:                 # Required\n            schedule: &lt;boolean&gt;\n            github_webhook: &lt;boolean&gt;\n            on_merge: &lt;boolean&gt;\n          # ... many more optional fields\n\n  environment_variables:            # Optional\n    - name: &lt;string&gt;                # Must start with DBT_\n      environment_values:\n        - env: &lt;string&gt;\n          value: &lt;string&gt;\n</code></pre>"},{"location":"getting-started/examples/#more-examples-coming-soon","title":"More Examples Coming Soon","text":"<ul> <li>Snowflake Integration</li> <li>Databricks Unity Catalog</li> <li>BigQuery with Service Accounts</li> <li>GitLab CI/CD Pipeline</li> <li>Azure DevOps Integration</li> </ul> <p>Want to contribute an example? Open a PR!</p>"},{"location":"getting-started/quickstart/","title":"Quick Start Guide","text":"<p>Get your dbt Cloud project set up with Terraform in under 5 minutes.</p>"},{"location":"getting-started/quickstart/#prerequisites","title":"Prerequisites","text":"<p>Before you begin, make sure you have:</p> <ul> <li> Terraform &gt;= 1.0 installed</li> <li> dbt Cloud account with admin access</li> <li> dbt Cloud API token (Get one here)</li> <li> Git repository with your dbt project</li> </ul>"},{"location":"getting-started/quickstart/#step-1-clone-the-example","title":"Step 1: Clone the Example","text":"<p>Start with the basic example as a template:</p> <pre><code>git clone https://github.com/trouze/dbt-terraform-modules-yaml.git\ncd dbt-terraform-modules-yaml/examples/basic\n\n# Or copy to your own directory\ncp -r examples/basic ~/my-dbt-setup\ncd ~/my-dbt-setup\n</code></pre> <p>The basic example includes:</p> <pre><code>basic/\n\u251c\u2500\u2500 main.tf              # Terraform configuration\n\u251c\u2500\u2500 variables.tf         # Input variable definitions\n\u251c\u2500\u2500 dbt-config.yml      # Your dbt Cloud configuration\n\u2514\u2500\u2500 .env.example        # Credential template\n</code></pre>"},{"location":"getting-started/quickstart/#step-2-configure-your-credentials","title":"Step 2: Configure Your Credentials","text":"<p>Create a <code>.env</code> file for your dbt Cloud credentials:</p> <pre><code>cp .env.example .env\n</code></pre> <p>Edit <code>.env</code> with your actual values:</p> <pre><code># Required: dbt Cloud credentials\nexport TF_VAR_dbt_account_id=12345\nexport TF_VAR_dbt_api_token=dbtc_xxxxxxxxxxxxx\nexport TF_VAR_dbt_pat=dbtc_xxxxxxxxxxxxx\nexport TF_VAR_dbt_host_url=https://cloud.getdbt.com/api\n\n# Optional: Path to your YAML config (you can pass this via -var flag to switch between projects easily)\nexport TF_VAR_yaml_file_path=./dbt-config.yml\n\n# Optional: Database credential tokens (if using Databricks, Snowflake, etc.)\nexport TF_VAR_token_map='{\"my_credential\":\"abc123\"}'\n</code></pre> <p>Where to find these values</p> <ul> <li>Account ID: Found in your dbt Cloud URL: <code>https://cloud.getdbt.com/accounts/{account_id}/</code></li> <li>API Token: Generate at https://cloud.getdbt.com/settings/profile</li> <li>PAT: Same as API Token (Personal Access Token)</li> <li>Host URL: <code>https://cloud.getdbt.com/api</code> for US, check docs for other regions</li> </ul> <p>Security</p> <p>Never commit <code>.env</code> to version control! It's already in <code>.gitignore</code>.</p>"},{"location":"getting-started/quickstart/#step-3-configure-your-dbt-project","title":"Step 3: Configure Your dbt Project","text":"<p>Edit <code>dbt-config.yml</code> with your project details:</p> <pre><code>project:\n  name: \"my-dbt-project\"\n  repository:\n    remote_url: \"https://github.com/myorg/my-dbt-repo.git\"\n    git_clone_strategy: \"github_app\"  # or \"deploy_key\", \"gitlab_deploy_token\"\n    github_installation_id: 123456     # Your GitHub App installation ID\n\n  environments:\n    - name: \"Production\"\n      type: \"deployment\"\n      connection_id: 1  # Your dbt Cloud connection ID\n      credential:\n        token_name: \"databricks_token\"  # Maps to token_map\n        schema: \"prod\"\n      jobs:\n        - name: \"Daily Production Run\"\n          execute_steps:\n            - \"dbt run\"\n            - \"dbt test\"\n          triggers:\n            schedule: true\n            schedule_hours: [6]  # 6 AM daily\n            schedule_days: [0, 1, 2, 3, 4]  # Weekdays\n</code></pre> <p>Git Clone Strategies</p> <p>Choose based on your Git provider:</p> <ul> <li>GitHub: <code>github_app</code> (recommended) or <code>deploy_key</code></li> <li>GitLab: <code>gitlab_deploy_token</code> or <code>deploy_key</code></li> <li>Azure DevOps: <code>azure_active_directory_app</code></li> <li>Other: <code>deploy_key</code> (universal SSH)</li> </ul>"},{"location":"getting-started/quickstart/#step-4-initialize-terraform","title":"Step 4: Initialize Terraform","text":"<p>Load your credentials and initialize:</p> <pre><code># Load credentials from .env\nsource .env\n\n# Initialize Terraform\nterraform init\n</code></pre> <p>You should see:</p> <pre><code>Initializing modules...\nDownloading git::https://github.com/trouze/dbt-terraform-modules-yaml.git...\n\nTerraform has been successfully initialized!\n</code></pre>"},{"location":"getting-started/quickstart/#step-5-preview-changes","title":"Step 5: Preview Changes","text":"<p>Always review what Terraform will create:</p> <pre><code>terraform plan\n</code></pre> <p>You'll see an output like:</p> <pre><code>Plan: 8 to add, 0 to change, 0 to destroy.\n\nChanges to Outputs:\n  + project_id      = (known after apply)\n  + repository_id   = (known after apply)\n  + environment_ids = {\n      + \"Production\" = (known after apply)\n    }\n</code></pre> <p>Understanding the Plan</p> <ul> <li>Resources being created: Project, repository, environments, credentials, jobs</li> <li>Nothing exists yet: Resources are only created when you run <code>apply</code></li> <li>Review carefully: Make sure connection IDs, URLs, and names are correct</li> </ul>"},{"location":"getting-started/quickstart/#step-6-apply-configuration","title":"Step 6: Apply Configuration","text":"<p>Create your dbt Cloud infrastructure:</p> <pre><code>terraform apply\n</code></pre> <p>Type <code>yes</code> when prompted. Terraform will create:</p> <ol> <li>\u2705 dbt Cloud project</li> <li>\u2705 Repository connection</li> <li>\u2705 Environments (Production, Development, etc.)</li> <li>\u2705 Credentials (database connections)</li> <li>\u2705 Jobs (scheduled runs, CI checks)</li> </ol> <pre><code>Apply complete! Resources: 8 added, 0 changed, 0 destroyed.\n\nOutputs:\nproject_id = 12345\nrepository_id = 67890\nenvironment_ids = {\n  \"Production\" = 11111\n}\n</code></pre>"},{"location":"getting-started/quickstart/#step-7-verify-in-dbt-cloud","title":"Step 7: Verify in dbt Cloud","text":"<ol> <li>Log into dbt Cloud</li> <li>Navigate to your account</li> <li>You should see your new project!</li> <li>Check that environments and jobs are configured correctly</li> </ol>"},{"location":"getting-started/quickstart/#whats-next","title":"What's Next?","text":"<ul> <li> <p> Customize Your Setup</p> <p>Learn about all configuration options</p> <p> YAML Schema</p> </li> <li> <p>:material-github-box:{ .lg .middle } CI/CD Integration</p> <p>Automate deployments with GitHub Actions</p> <p> CI/CD Guide</p> </li> <li> <p> More Examples</p> <p>See real-world use cases</p> <p> Examples</p> </li> <li> <p> Need Help?</p> <p>Common issues and solutions</p> <p> Troubleshooting</p> </li> </ul>"},{"location":"getting-started/quickstart/#making-changes","title":"Making Changes","text":"<p>After initial setup, you can modify your configuration:</p> <ol> <li>Edit <code>dbt-config.yml</code></li> <li>Run <code>terraform plan</code> to preview changes</li> <li>Run <code>terraform apply</code> to apply them</li> </ol> <pre><code># Example: Add a new environment\nnano dbt-config.yml  # Add new environment\nsource .env\nterraform plan      # Review changes\nterraform apply     # Apply changes\n</code></pre> <p>You're All Set!</p> <p>Your dbt Cloud project is now managed as code. All changes are tracked in Git and deployed via Terraform.</p>"},{"location":"guides/best-practices/","title":"Best Practices","text":"<p>Recommended patterns for managing dbt Cloud infrastructure with Terraform.</p>"},{"location":"guides/best-practices/#security","title":"Security","text":""},{"location":"guides/best-practices/#credential-management","title":"Credential Management","text":"<p>\u2705 Use environment variables for all sensitive data:</p> <pre><code># .env file (never commit)\nexport TF_VAR_dbt_api_token=dbtc_xxxxx\nexport TF_VAR_token_map='{\"key\":\"value\"}'\n</code></pre> <p>\u274c Never hardcode credentials:</p> <pre><code># DON'T DO THIS!\nvariable \"dbt_token\" {\n  default = \"dbtc_xxxxx\"  # \u274c Exposed in version control\n}\n</code></pre>"},{"location":"guides/best-practices/#token-security","title":"Token Security","text":"<ul> <li>Use service accounts instead of personal tokens</li> <li>Rotate tokens every 90 days</li> <li>Limit permissions to minimum required</li> <li>Use different tokens for dev/staging/prod</li> <li>Store in secrets managers (GitHub Secrets, Vault, etc.)</li> </ul>"},{"location":"guides/best-practices/#gitignore","title":"Gitignore","text":"<p>Always exclude sensitive files:</p> .gitignore<pre><code># Terraform\n*.tfstate\n*.tfstate.*\n.terraform/\n.terraform.lock.hcl\ncrash.log\noverride.tf\noverride.tf.json\n\n# Credentials\n.env\n.env.local\n*.tfvars\n!*.tfvars.example\nterraform.rc\n.terraformrc\n\n# IDE\n.vscode/\n.idea/\n*.swp\n</code></pre>"},{"location":"guides/best-practices/#code-organization","title":"Code Organization","text":""},{"location":"guides/best-practices/#directory-structure","title":"Directory Structure","text":"<p>Recommended layout:</p> <pre><code>my-dbt-infrastructure/\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u2514\u2500\u2500 deploy.yml\n\u251c\u2500\u2500 terraform/\n\u2502   \u251c\u2500\u2500 main.tf\n\u2502   \u251c\u2500\u2500 variables.tf\n\u2502   \u251c\u2500\u2500 outputs.tf\n\u2502   \u251c\u2500\u2500 backend.tf\n\u2502   \u2514\u2500\u2500 versions.tf\n\u251c\u2500\u2500 configs/\n\u2502   \u251c\u2500\u2500 production.yml\n\u2502   \u251c\u2500\u2500 staging.yml\n\u2502   \u2514\u2500\u2500 development.yml\n\u251c\u2500\u2500 docs/\n\u2502   \u2514\u2500\u2500 README.md\n\u251c\u2500\u2500 .env.example\n\u251c\u2500\u2500 .gitignore\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"guides/best-practices/#file-naming","title":"File Naming","text":"<p>Use clear, descriptive names:</p> <ul> <li><code>main.tf</code> - Primary module configuration</li> <li><code>variables.tf</code> - Input variable definitions</li> <li><code>outputs.tf</code> - Output value definitions</li> <li><code>backend.tf</code> - State backend configuration</li> <li><code>versions.tf</code> - Provider version constraints</li> </ul>"},{"location":"guides/best-practices/#module-version-pinning","title":"Module Version Pinning","text":"<p>Always pin module versions:</p> <pre><code>module \"dbt_cloud\" {\n  source = \"git::https://github.com/trouze/dbt-terraform-modules-yaml.git?ref=v1.0.0\"\n  # NOT: source = \"git::https://github.com/...\"  # \u274c Unpredictable\n}\n</code></pre>"},{"location":"guides/best-practices/#yaml-configuration","title":"YAML Configuration","text":""},{"location":"guides/best-practices/#naming-conventions","title":"Naming Conventions","text":"<p>Use consistent, descriptive names:</p> <pre><code>project:\n  name: \"analytics-production\"  # \u2705 Clear and specific\n  # NOT: name: \"project1\"       # \u274c Vague\n\n  environments:\n    - name: \"Production\"         # \u2705 Proper case\n      # NOT: name: \"prod\"        # \u274c Abbreviation\n</code></pre>"},{"location":"guides/best-practices/#comments","title":"Comments","text":"<p>Document non-obvious configurations:</p> <pre><code>project:\n  environments:\n    - name: \"Production\"\n      # Using connection_id 1001 for Databricks Unity Catalog\n      connection_id: 1001\n\n      jobs:\n        - name: \"Daily Run\"\n          # Runs at 6 AM UTC (2 AM ET)\n          schedule_hours: [6]\n</code></pre>"},{"location":"guides/best-practices/#environment-specific-values","title":"Environment-Specific Values","text":"<p>Keep environment configs consistent:</p> <pre><code># \u2705 Good: Consistent structure across environments\nenvironments:\n  - name: \"Development\"\n    type: \"development\"\n    credential:\n      token_name: \"dev_databricks\"\n      schema: \"dev_analytics\"\n\n  - name: \"Production\"\n    type: \"deployment\"\n    credential:\n      token_name: \"prod_databricks\"\n      schema: \"analytics\"\n</code></pre>"},{"location":"guides/best-practices/#state-management","title":"State Management","text":""},{"location":"guides/best-practices/#remote-state","title":"Remote State","text":"<p>Always use remote state for teams:</p> backend.tf<pre><code>terraform {\n  backend \"s3\" {\n    bucket         = \"my-company-terraform-state\"\n    key            = \"dbt-cloud/production/terraform.tfstate\"\n    region         = \"us-east-1\"\n    encrypt        = true\n    dynamodb_table = \"terraform-lock\"\n  }\n}\n</code></pre>"},{"location":"guides/best-practices/#state-locking","title":"State Locking","text":"<p>Enable locking to prevent concurrent modifications:</p> <pre><code># S3 + DynamoDB (AWS)\nterraform {\n  backend \"s3\" {\n    bucket         = \"state-bucket\"\n    key            = \"dbt/terraform.tfstate\"\n    dynamodb_table = \"terraform-locks\"\n  }\n}\n\n# Azure Blob Storage\nterraform {\n  backend \"azurerm\" {\n    storage_account_name = \"tfstate\"\n    container_name       = \"tfstate\"\n    key                  = \"dbt.tfstate\"\n  }\n}\n</code></pre>"},{"location":"guides/best-practices/#state-backup","title":"State Backup","text":"<p>Always maintain state backups:</p> <pre><code># Before major changes\nterraform state pull &gt; backup-$(date +%Y%m%d-%H%M%S).tfstate\n</code></pre>"},{"location":"guides/best-practices/#testing-validation","title":"Testing &amp; Validation","text":""},{"location":"guides/best-practices/#pre-deployment-checks","title":"Pre-Deployment Checks","text":"<p>Always validate before applying:</p> <pre><code># 1. Format check\nterraform fmt -check -recursive\n\n# 2. Validation\nterraform validate\n\n# 3. Plan review\nterraform plan -out=tfplan\n\n# 4. Manual review\nterraform show tfplan\n\n# 5. Apply only if satisfied\nterraform apply tfplan\n</code></pre>"},{"location":"guides/best-practices/#yaml-validation","title":"YAML Validation","text":"<p>Use schema validation in IDE:</p> <pre><code># Add to top of dbt-config.yml\n# yaml-language-server: $schema=https://raw.githubusercontent.com/trouze/dbt-terraform-modules-yaml/main/schemas/v1.json\n\nproject:\n  name: \"my-project\"\n</code></pre>"},{"location":"guides/best-practices/#automated-testing","title":"Automated Testing","text":"<p>Run tests in CI/CD:</p> <pre><code>steps:\n  - name: Terraform Format Check\n    run: terraform fmt -check -recursive\n\n  - name: Terraform Validate\n    run: terraform validate\n\n  - name: YAML Lint\n    uses: ibiqlik/action-yamllint@v3\n</code></pre>"},{"location":"guides/best-practices/#cicd-best-practices","title":"CI/CD Best Practices","text":""},{"location":"guides/best-practices/#branch-protection","title":"Branch Protection","text":"<p>Protect production branches:</p> <ul> <li>Require pull request reviews</li> <li>Require status checks to pass</li> <li>Require up-to-date branches</li> <li>Include administrators in restrictions</li> </ul>"},{"location":"guides/best-practices/#pull-request-workflow","title":"Pull Request Workflow","text":"<ol> <li>Branch from main: <code>git checkout -b feature/add-prod-job</code></li> <li>Make changes to YAML or Terraform</li> <li>Commit with clear messages</li> <li>Push and create PR</li> <li>Review automated plan output</li> <li>Approve and merge</li> <li>Automated apply on merge to main</li> </ol>"},{"location":"guides/best-practices/#deployment-strategy","title":"Deployment Strategy","text":"<p>Use progressive deployment:</p> <pre><code>Development \u2192 Staging \u2192 Production\n</code></pre> <pre><code># Deploy to dev automatically\non:\n  push:\n    branches: [develop]\n\n# Deploy to staging on PR merge\non:\n  pull_request:\n    types: [closed]\n    branches: [main]\n\n# Deploy to prod manually\nwhen: manual\n</code></pre>"},{"location":"guides/best-practices/#performance","title":"Performance","text":""},{"location":"guides/best-practices/#parallelism","title":"Parallelism","text":"<p>Optimize for multiple projects:</p> <pre><code># GitHub Actions\nstrategy:\n  matrix:\n    project: [finance, marketing, operations]\n  max-parallel: 3\n</code></pre>"},{"location":"guides/best-practices/#caching","title":"Caching","text":"<p>Cache Terraform plugins:</p> <pre><code>- name: Cache Terraform Plugins\n  uses: actions/cache@v3\n  with:\n    path: ~/.terraform.d/plugin-cache\n    key: ${{ runner.os }}-terraform-${{ hashFiles('**/.terraform.lock.hcl') }}\n</code></pre>"},{"location":"guides/best-practices/#resource-timeouts","title":"Resource Timeouts","text":"<p>Set appropriate timeouts:</p> <pre><code>jobs:\n  - name: \"Large Job\"\n    timeout_seconds: 7200  # 2 hours for complex runs\n</code></pre>"},{"location":"guides/best-practices/#monitoring-observability","title":"Monitoring &amp; Observability","text":""},{"location":"guides/best-practices/#terraform-cloud","title":"Terraform Cloud","text":"<p>Use Terraform Cloud for visibility:</p> <pre><code>terraform {\n  cloud {\n    organization = \"my-company\"\n    workspaces {\n      name = \"dbt-cloud-production\"\n    }\n  }\n}\n</code></pre>"},{"location":"guides/best-practices/#notifications","title":"Notifications","text":"<p>Set up alerts for failures:</p> <pre><code># GitHub Actions\n- name: Notify on Failure\n  if: failure()\n  uses: slackapi/slack-github-action@v1\n  with:\n    payload: |\n      {\n        \"text\": \"Terraform deployment failed: ${{ github.workflow }}\"\n      }\n  env:\n    SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK }}\n</code></pre>"},{"location":"guides/best-practices/#logging","title":"Logging","text":"<p>Capture detailed logs:</p> <pre><code>- name: Terraform Apply\n  run: terraform apply -auto-approve 2&gt;&amp;1 | tee terraform.log\n\n- name: Upload Logs\n  if: always()\n  uses: actions/upload-artifact@v3\n  with:\n    name: terraform-logs\n    path: terraform.log\n</code></pre>"},{"location":"guides/best-practices/#documentation","title":"Documentation","text":""},{"location":"guides/best-practices/#readme-template","title":"README Template","text":"<p>Every project should have:</p> <pre><code># dbt Cloud Infrastructure - [Project Name]\n\n## Overview\nBrief description of what this manages.\n\n## Prerequisites\n- Terraform &gt;= 1.0\n- dbt Cloud account\n- Required permissions\n\n## Setup\n\\`\\`\\`bash\n# Clone and configure\ngit clone &lt;repo&gt;\ncp .env.example .env\n# Edit .env with credentials\n\\`\\`\\`\n\n## Usage\n\\`\\`\\`bash\nsource .env\nterraform init\nterraform plan\nterraform apply\n\\`\\`\\`\n\n## Configuration\nLink to YAML schema and examples.\n\n## CI/CD\nDescribe automated deployment process.\n\n## Support\nWhere to get help.\n</code></pre>"},{"location":"guides/best-practices/#inline-documentation","title":"Inline Documentation","text":"<p>Use Terraform comments:</p> <pre><code># Configure dbt Cloud provider\n# Requires: DBT_ACCOUNT_ID and DBT_API_TOKEN env vars\nprovider \"dbtcloud\" {\n  account_id = var.dbt_account_id  # Found in dbt Cloud URL\n  token      = var.dbt_api_token   # Generate in Profile settings\n  host_url   = var.dbt_host_url    # Regional API endpoint\n}\n</code></pre>"},{"location":"guides/best-practices/#change-management","title":"Change Management","text":"<p>Document major changes:</p> <pre><code>## Changelog\n\n### 2024-01-15\n- Added staging environment\n- Updated prod job schedule to 6 AM UTC\n- Migrated from GitHub Deploy Key to GitHub App\n\n### 2024-01-10\n- Initial production deployment\n- Configured Databricks credentials\n</code></pre>"},{"location":"guides/best-practices/#common-patterns","title":"Common Patterns","text":""},{"location":"guides/best-practices/#multiple-environments","title":"Multiple Environments","text":"<pre><code>environments:\n  # Development: Full access, custom branch\n  - name: \"Development\"\n    type: \"development\"\n    custom_branch: \"develop\"\n    enable_model_query_history: true\n\n  # Staging: Production-like, limited access\n  - name: \"Staging\"\n    type: \"deployment\"\n    dbt_version: \"1.7.1\"  # Pin to same as prod\n    jobs:\n      - name: \"Staging CI\"\n        triggers:\n          on_merge: true\n        deferring_environment: \"Production\"\n\n  # Production: Locked down, scheduled\n  - name: \"Production\"\n    type: \"deployment\"\n    dbt_version: \"1.7.1\"\n    jobs:\n      - name: \"Daily Run\"\n        triggers:\n          schedule: true\n        schedule_hours: [6]\n</code></pre>"},{"location":"guides/best-practices/#job-naming","title":"Job Naming","text":"<p>Use consistent, descriptive names:</p> <pre><code>jobs:\n  # \u2705 Good\n  - name: \"Production Daily Full Refresh\"\n  - name: \"Staging CI - Modified Models Only\"\n  - name: \"Development - Ad Hoc Testing\"\n\n  # \u274c Bad\n  - name: \"job1\"\n  - name: \"run\"\n  - name: \"test\"\n</code></pre>"},{"location":"guides/best-practices/#credential-mapping","title":"Credential Mapping","text":"<p>Organize by environment and warehouse:</p> <pre><code>export TF_VAR_token_map='{\n  \"dev_databricks_uc\": \"dapi_dev123\",\n  \"staging_databricks_uc\": \"dapi_stg456\",\n  \"prod_databricks_uc\": \"dapi_prd789\",\n  \"dev_snowflake\": \"sf_dev_abc\",\n  \"prod_snowflake\": \"sf_prd_xyz\"\n}'\n</code></pre>"},{"location":"guides/best-practices/#checklist","title":"Checklist","text":"<p>Before deploying to production:</p> <ul> <li> All credentials in environment variables or secrets manager</li> <li> <code>.env</code> and <code>*.tfvars</code> in <code>.gitignore</code></li> <li> Remote state backend configured</li> <li> State locking enabled</li> <li> Terraform version pinned</li> <li> Module version pinned</li> <li> YAML validated against schema</li> <li> <code>terraform plan</code> reviewed</li> <li> CI/CD pipeline tested</li> <li> Rollback plan documented</li> <li> Team notified of changes</li> <li> Monitoring/alerts configured</li> </ul>"},{"location":"guides/best-practices/#getting-help","title":"Getting Help","text":"<ul> <li>\ud83d\udcd6 Documentation</li> <li>\ud83d\udc1b Issues</li> <li>\ud83d\udcac Discussions</li> </ul>"},{"location":"guides/cicd/","title":"CI/CD Integration","text":"<p>Automate your dbt Cloud infrastructure deployments using CI/CD pipelines.</p>"},{"location":"guides/cicd/#overview","title":"Overview","text":"<p>This module integrates seamlessly with popular CI/CD platforms:</p> <ul> <li>GitHub Actions - Native GitHub integration</li> <li>GitLab CI/CD - Built into GitLab</li> <li>Azure DevOps Pipelines - Microsoft Azure</li> <li>Jenkins - Self-hosted automation</li> <li>CircleCI - Cloud-based CI/CD</li> </ul> <p>All examples use environment variables for credentials, making them portable across platforms.</p>"},{"location":"guides/cicd/#github-actions","title":"GitHub Actions","text":""},{"location":"guides/cicd/#basic-workflow","title":"Basic Workflow","text":"<p>Deploy on push to main:</p> .github/workflows/dbt-cloud.yml<pre><code>name: Deploy dbt Cloud Infrastructure\n\non:\n  push:\n    branches: [main]\n    paths:\n      - 'dbt-config.yml'\n      - '**.tf'\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n        with:\n          terraform_version: 1.6.0\n\n      - name: Terraform Init\n        run: terraform init\n\n      - name: Terraform Plan\n        env:\n          TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n          TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n          TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n          TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n          TF_VAR_yaml_file_path: ./dbt-config.yml\n          TF_VAR_token_map: ${{ secrets.TOKEN_MAP }}\n        run: terraform plan -out=tfplan\n\n      - name: Terraform Apply\n        env:\n          TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n          TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n          TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n          TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n          TF_VAR_yaml_file_path: ./dbt-config.yml\n          TF_VAR_token_map: ${{ secrets.TOKEN_MAP }}\n        run: terraform apply tfplan\n</code></pre>"},{"location":"guides/cicd/#with-pull-request-preview","title":"With Pull Request Preview","text":"<p>Show plan in PR comments:</p> .github/workflows/terraform-pr.yml<pre><code>name: Terraform PR Check\n\non:\n  pull_request:\n    paths:\n      - 'dbt-config.yml'\n      - '**.tf'\n\npermissions:\n  contents: read\n  pull-requests: write\n\njobs:\n  plan:\n    runs-on: ubuntu-latest\n\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n\n      - name: Terraform Init\n        run: terraform init\n\n      - name: Terraform Plan\n        id: plan\n        env:\n          TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n          TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n          TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n          TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n          TF_VAR_yaml_file_path: ./dbt-config.yml\n          TF_VAR_token_map: ${{ secrets.TOKEN_MAP }}\n        run: terraform plan -no-color\n        continue-on-error: true\n\n      - name: Comment Plan on PR\n        uses: actions/github-script@v6\n        with:\n          script: |\n            const output = `#### Terraform Plan \ud83d\udccb\n\n            \\`\\`\\`\n            ${{ steps.plan.outputs.stdout }}\n            \\`\\`\\`\n\n            *Pushed by: @${{ github.actor }}, Action: \\`${{ github.event_name }}\\`*`;\n\n            github.rest.issues.createComment({\n              issue_number: context.issue.number,\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              body: output\n            })\n</code></pre>"},{"location":"guides/cicd/#multi-project-matrix","title":"Multi-Project Matrix","text":"<p>Deploy multiple projects in parallel:</p> .github/workflows/multi-project.yml<pre><code>name: Deploy Multiple Projects\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        project: [finance, marketing, operations]\n      fail-fast: false\n\n    steps:\n      - uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n\n      - name: Terraform Init\n        run: terraform init\n\n      - name: Deploy ${{ matrix.project }}\n        env:\n          TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n          TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n          TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n          TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n          TF_VAR_yaml_file_path: ./configs/${{ matrix.project }}.yml\n          TF_VAR_token_map: ${{ secrets.TOKEN_MAP }}\n        run: |\n          terraform workspace select -or-create ${{ matrix.project }}\n          terraform plan -out=tfplan\n          terraform apply tfplan\n</code></pre>"},{"location":"guides/cicd/#gitlab-cicd","title":"GitLab CI/CD","text":""},{"location":"guides/cicd/#basic-pipeline","title":"Basic Pipeline","text":".gitlab-ci.yml<pre><code>stages:\n  - validate\n  - plan\n  - apply\n\nvariables:\n  TF_ROOT: ${CI_PROJECT_DIR}\n  TF_VAR_dbt_host_url: \"https://cloud.getdbt.com/api\"\n  TF_VAR_yaml_file_path: \"./dbt-config.yml\"\n\n.terraform-base:\n  image: hashicorp/terraform:latest\n  before_script:\n    - cd ${TF_ROOT}\n    - terraform init\n\nvalidate:\n  extends: .terraform-base\n  stage: validate\n  script:\n    - terraform fmt -check\n    - terraform validate\n\nplan:\n  extends: .terraform-base\n  stage: plan\n  variables:\n    TF_VAR_dbt_account_id: ${DBT_ACCOUNT_ID}\n    TF_VAR_dbt_api_token: ${DBT_API_TOKEN}\n    TF_VAR_dbt_pat: ${DBT_PAT}\n    TF_VAR_token_map: ${TOKEN_MAP}\n  script:\n    - terraform plan -out=tfplan\n  artifacts:\n    paths:\n      - ${TF_ROOT}/tfplan\n    expire_in: 1 day\n\napply:\n  extends: .terraform-base\n  stage: apply\n  variables:\n    TF_VAR_dbt_account_id: ${DBT_ACCOUNT_ID}\n    TF_VAR_dbt_api_token: ${DBT_API_TOKEN}\n    TF_VAR_dbt_pat: ${DBT_PAT}\n    TF_VAR_token_map: ${TOKEN_MAP}\n  script:\n    - terraform apply tfplan\n  dependencies:\n    - plan\n  only:\n    - main\n  when: manual\n</code></pre>"},{"location":"guides/cicd/#azure-devops","title":"Azure DevOps","text":"azure-pipelines.yml<pre><code>trigger:\n  branches:\n    include:\n      - main\n  paths:\n    include:\n      - dbt-config.yml\n      - '*.tf'\n\npool:\n  vmImage: 'ubuntu-latest'\n\nvariables:\n  - group: dbt-cloud-credentials\n  - name: TF_VAR_dbt_host_url\n    value: 'https://cloud.getdbt.com/api'\n  - name: TF_VAR_yaml_file_path\n    value: './dbt-config.yml'\n\nstages:\n  - stage: Plan\n    jobs:\n      - job: TerraformPlan\n        steps:\n          - task: TerraformInstaller@0\n            inputs:\n              terraformVersion: 'latest'\n\n          - task: TerraformTaskV2@2\n            displayName: 'Terraform Init'\n            inputs:\n              command: 'init'\n              workingDirectory: '$(System.DefaultWorkingDirectory)'\n\n          - task: TerraformTaskV2@2\n            displayName: 'Terraform Plan'\n            inputs:\n              command: 'plan'\n              workingDirectory: '$(System.DefaultWorkingDirectory)'\n              environmentServiceNameAzureRM: 'terraform-sp'\n            env:\n              TF_VAR_dbt_account_id: $(DBT_ACCOUNT_ID)\n              TF_VAR_dbt_api_token: $(DBT_API_TOKEN)\n              TF_VAR_dbt_pat: $(DBT_PAT)\n              TF_VAR_token_map: $(TOKEN_MAP)\n\n  - stage: Apply\n    dependsOn: Plan\n    condition: and(succeeded(), eq(variables['Build.SourceBranch'], 'refs/heads/main'))\n    jobs:\n      - deployment: TerraformApply\n        environment: 'production'\n        strategy:\n          runOnce:\n            deploy:\n              steps:\n                - task: TerraformTaskV2@2\n                  displayName: 'Terraform Apply'\n                  inputs:\n                    command: 'apply'\n                    workingDirectory: '$(System.DefaultWorkingDirectory)'\n                  env:\n                    TF_VAR_dbt_account_id: $(DBT_ACCOUNT_ID)\n                    TF_VAR_dbt_api_token: $(DBT_API_TOKEN)\n                    TF_VAR_dbt_pat: $(DBT_PAT)\n                    TF_VAR_token_map: $(TOKEN_MAP)\n</code></pre>"},{"location":"guides/cicd/#best-practices","title":"Best Practices","text":""},{"location":"guides/cicd/#1-secret-management","title":"1. Secret Management","text":"<p>\u2705 DO: - Use platform-native secrets (GitHub Secrets, GitLab Variables, etc.) - Mark secrets as \"masked\" or \"protected\" - Use different secrets for dev/staging/prod - Rotate secrets regularly</p> <p>\u274c DON'T: - Hardcode credentials in workflow files - Echo secrets in logs - Share secrets across unrelated projects</p>"},{"location":"guides/cicd/#2-environment-separation","title":"2. Environment Separation","text":"<p>Use different workflows for environments:</p> <pre><code># Production\non:\n  push:\n    branches: [main]\n\n# Staging\non:\n  push:\n    branches: [staging]\n\n# Development\non:\n  push:\n    branches: [develop]\n</code></pre>"},{"location":"guides/cicd/#3-approval-gates","title":"3. Approval Gates","text":"<p>Require manual approval for production:</p> <p>GitHub Actions: <pre><code>environment:\n  name: production\n  url: https://cloud.getdbt.com\n</code></pre></p> <p>GitLab CI/CD: <pre><code>apply:\n  when: manual\n  only:\n    - main\n</code></pre></p>"},{"location":"guides/cicd/#4-plan-artifact","title":"4. Plan Artifact","text":"<p>Save plan output for review:</p> <pre><code>- name: Save Plan\n  run: terraform show -no-color tfplan &gt; plan.txt\n\n- name: Upload Plan\n  uses: actions/upload-artifact@v3\n  with:\n    name: terraform-plan\n    path: plan.txt\n</code></pre>"},{"location":"guides/cicd/#5-parallel-execution","title":"5. Parallel Execution","text":"<p>Use matrix strategy for multiple projects:</p> <pre><code>strategy:\n  matrix:\n    project: [a, b, c]\n  fail-fast: false  # Continue even if one fails\n  max-parallel: 3   # Limit concurrent jobs\n</code></pre>"},{"location":"guides/cicd/#troubleshooting","title":"Troubleshooting","text":""},{"location":"guides/cicd/#no-value-for-required-variable","title":"\"No value for required variable\"","text":"<p>Problem: Secrets not loaded.</p> <p>Solution: - Verify secrets are defined in CI/CD platform - Check variable names match exactly - Ensure workflow has access to secrets</p>"},{"location":"guides/cicd/#state-lock-timeout","title":"\"State Lock Timeout\"","text":"<p>Problem: Previous run didn't release state lock.</p> <p>Solution: <pre><code>- name: Force Unlock (emergency only)\n  run: terraform force-unlock -force &lt;LOCK_ID&gt;\n</code></pre></p>"},{"location":"guides/cicd/#plan-changes-unexpectedly","title":"\"Plan Changes Unexpectedly\"","text":"<p>Problem: State drift or external changes.</p> <p>Solution: - Run <code>terraform refresh</code> to sync state - Review changes carefully - Consider using <code>terraform import</code> for existing resources</p>"},{"location":"guides/cicd/#complete-example","title":"Complete Example","text":"<p>Putting it all together:</p> .github/workflows/complete.yml<pre><code>name: dbt Cloud Infrastructure\n\non:\n  pull_request:\n    paths: ['**.yml', '**.tf']\n  push:\n    branches: [main]\n    paths: ['**.yml', '**.tf']\n\npermissions:\n  contents: read\n  pull-requests: write\n\njobs:\n  terraform:\n    name: Terraform ${{ github.event_name == 'pull_request' &amp;&amp; 'Plan' || 'Apply' }}\n    runs-on: ubuntu-latest\n\n    env:\n      TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n      TF_VAR_dbt_api_token: ${{ secrets.DBT_API_TOKEN }}\n      TF_VAR_dbt_pat: ${{ secrets.DBT_PAT }}\n      TF_VAR_dbt_host_url: https://cloud.getdbt.com/api\n      TF_VAR_yaml_file_path: ./dbt-config.yml\n      TF_VAR_token_map: ${{ secrets.TOKEN_MAP }}\n\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v3\n\n      - name: Setup Terraform\n        uses: hashicorp/setup-terraform@v2\n        with:\n          terraform_version: 1.6.0\n\n      - name: Terraform Format Check\n        run: terraform fmt -check -recursive\n\n      - name: Terraform Init\n        run: terraform init\n\n      - name: Terraform Validate\n        run: terraform validate\n\n      - name: Terraform Plan\n        id: plan\n        run: |\n          terraform plan -no-color -out=tfplan\n          terraform show -no-color tfplan &gt; plan.txt\n\n      - name: Comment Plan on PR\n        if: github.event_name == 'pull_request'\n        uses: actions/github-script@v6\n        with:\n          script: |\n            const fs = require('fs');\n            const plan = fs.readFileSync('plan.txt', 'utf8');\n            const output = `#### Terraform Plan \ud83d\udccb\n            &lt;details&gt;&lt;summary&gt;Show Plan&lt;/summary&gt;\n\n            \\`\\`\\`\n            ${plan}\n            \\`\\`\\`\n\n            &lt;/details&gt;\n\n            *Pusher: @${{ github.actor }}, Action: \\`${{ github.event_name }}\\`*`;\n\n            github.rest.issues.createComment({\n              issue_number: context.issue.number,\n              owner: context.repo.owner,\n              repo: context.repo.repo,\n              body: output\n            })\n\n      - name: Terraform Apply\n        if: github.ref == 'refs/heads/main' &amp;&amp; github.event_name == 'push'\n        run: terraform apply -auto-approve tfplan\n\n      - name: Upload Plan Artifact\n        if: always()\n        uses: actions/upload-artifact@v3\n        with:\n          name: terraform-plan\n          path: plan.txt\n          retention-days: 30\n</code></pre>"},{"location":"guides/cicd/#next-steps","title":"Next Steps","text":"<ul> <li> <p> Multi-Project Setup</p> <p>Manage multiple dbt projects</p> <p> Multi-Project Guide</p> </li> <li> <p> Best Practices</p> <p>Secure and reliable deployments</p> <p> Best Practices</p> </li> </ul>"},{"location":"guides/troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and their solutions.</p>"},{"location":"guides/troubleshooting/#terraform-errors","title":"Terraform Errors","text":""},{"location":"guides/troubleshooting/#no-value-for-required-variable","title":"\"No value for required variable\"","text":"<p>Error Message: <pre><code>Error: No value for required variable\n\u2502 on variables.tf line 1:\n\u2502   1: variable \"dbt_account_id\" {\n\u2502 \n\u2502 The root module input variable \"dbt_account_id\" is not set\n</code></pre></p> <p>Causes: - Environment variables not loaded - Incorrect variable name - Missing <code>.env</code> file</p> <p>Solutions:</p> <ol> <li> <p>Load environment variables: <pre><code>source .env\necho $TF_VAR_dbt_account_id  # Verify it's set\n</code></pre></p> </li> <li> <p>Check variable names match: <pre><code># In .env, must be TF_VAR_&lt;name&gt;\nexport TF_VAR_dbt_account_id=12345\n\n# In variables.tf\nvariable \"dbt_account_id\" {  # Name matches after TF_VAR_\n  type = number\n}\n</code></pre></p> </li> <li> <p>Pass directly: <pre><code>terraform plan -var=\"dbt_account_id=12345\"\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#invalid-json-for-token_map","title":"\"Invalid JSON for token_map\"","text":"<p>Error Message: <pre><code>Error: Invalid value for input variable\n\u2502 The given value is not suitable for var.token_map\n</code></pre></p> <p>Cause: <code>token_map</code> isn't valid JSON.</p> <p>Solutions:</p> <pre><code># \u274c Multi-line won't work in .env\nexport TF_VAR_token_map='{\n  \"key\": \"value\"\n}'\n\n# \u2705 Single line, use single quotes\nexport TF_VAR_token_map='{\"key\":\"value\",\"key2\":\"value2\"}'\n\n# \u2705 Or use terraform.tfvars (HCL syntax)\ntoken_map = {\n  key  = \"value\"\n  key2 = \"value2\"\n}\n</code></pre>"},{"location":"guides/troubleshooting/#state-lock-timeout","title":"\"State Lock Timeout\"","text":"<p>Error Message: <pre><code>Error: Error acquiring the state lock\n\u2502 Lock Info:\n\u2502   ID:        abc123...\n\u2502   Operation: OperationTypePlan\n\u2502   Who:       user@hostname\n</code></pre></p> <p>Causes: - Previous Terraform run didn't finish - Crashed Terraform process - Concurrent runs</p> <p>Solutions:</p> <ol> <li> <p>Wait for the other operation to complete</p> </li> <li> <p>Verify no other runs are active: <pre><code># Check for terraform processes\nps aux | grep terraform\n</code></pre></p> </li> <li> <p>Force unlock (use carefully): <pre><code>terraform force-unlock abc123\n</code></pre></p> </li> </ol> <p>Force Unlock Warning</p> <p>Only force unlock if you're CERTAIN no other process is running. This can corrupt state.</p>"},{"location":"guides/troubleshooting/#module-not-found","title":"\"Module not found\"","text":"<p>Error Message: <pre><code>Error: Module not installed\n\u2502 This configuration requires module \"dbt_cloud\"\n</code></pre></p> <p>Cause: Terraform modules not downloaded.</p> <p>Solution: <pre><code>terraform init\n# Or if already initialized\nterraform get\n</code></pre></p>"},{"location":"guides/troubleshooting/#dbt-cloud-api-errors","title":"dbt Cloud API Errors","text":""},{"location":"guides/troubleshooting/#401-unauthorized","title":"\"401 Unauthorized\"","text":"<p>Error Message: <pre><code>Error: dbt Cloud API error: 401 Unauthorized\n</code></pre></p> <p>Causes: - Invalid API token - Expired token - Wrong dbt Cloud account</p> <p>Solutions:</p> <ol> <li>Regenerate token:</li> <li>Go to dbt Cloud Profile</li> <li>Create new API token</li> <li> <p>Update <code>.env</code> or secrets</p> </li> <li> <p>Verify account ID: <pre><code># Check URL: https://cloud.getdbt.com/accounts/{ACCOUNT_ID}/\necho $TF_VAR_dbt_account_id\n</code></pre></p> </li> <li> <p>Check token format: <pre><code># Should start with 'dbtc_'\necho $TF_VAR_dbt_api_token\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#403-forbidden","title":"\"403 Forbidden\"","text":"<p>Error Message: <pre><code>Error: dbt Cloud API error: 403 Forbidden\n</code></pre></p> <p>Cause: Token doesn't have required permissions.</p> <p>Solutions:</p> <ol> <li>Use account-level token (not project-level)</li> <li>Check token permissions in dbt Cloud</li> <li>Create service account token with admin permissions</li> </ol>"},{"location":"guides/troubleshooting/#404-not-found-connection-id","title":"\"404 Not Found - Connection ID\"","text":"<p>Error Message: <pre><code>Error: Cannot find connection with ID: 1234\n</code></pre></p> <p>Cause: Connection ID doesn't exist or is in different account.</p> <p>Solutions:</p> <ol> <li>Find correct connection ID:</li> <li>In dbt Cloud: Admin &gt; Connections</li> <li> <p>Click connection, check URL: <code>/connections/{CONNECTION_ID}</code></p> </li> <li> <p>Update YAML: <pre><code>environments:\n  - name: \"Production\"\n    connection_id: 1234  # Use the correct ID\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#yaml-configuration-errors","title":"YAML Configuration Errors","text":""},{"location":"guides/troubleshooting/#yaml-parse-error","title":"\"YAML Parse Error\"","text":"<p>Error Message: <pre><code>Error: failed to parse YAML\n\u2502 yaml: line 10: did not find expected key\n</code></pre></p> <p>Causes: - Invalid YAML syntax - Incorrect indentation - Missing quotes</p> <p>Solutions:</p> <ol> <li> <p>Validate YAML syntax: <pre><code># Use yamllint\nyamllint dbt-config.yml\n\n# Or online validator\n# https://www.yamllint.com/\n</code></pre></p> </li> <li> <p>Check indentation (2 spaces, no tabs): <pre><code># \u274c Wrong\nproject:\n    name: \"test\"  # 4 spaces\n\n# \u2705 Correct\nproject:\n  name: \"test\"    # 2 spaces\n</code></pre></p> </li> <li> <p>Quote special characters: <pre><code># \u274c Wrong\nname: My Project: Production\n\n# \u2705 Correct\nname: \"My Project: Production\"\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#missing-required-field","title":"\"Missing Required Field\"","text":"<p>Error Message: <pre><code>Error: Missing required field: connection_id\n</code></pre></p> <p>Cause: Required field not provided in YAML.</p> <p>Solutions:</p> <p>Check the YAML Schema for required fields:</p> <pre><code>environments:\n  - name: \"Production\"        # Required\n    type: \"deployment\"        # Required\n    connection_id: 1001       # Required \u2190 Add this!\n    credential:               # Required\n      token_name: \"token\"     # Required\n      schema: \"analytics\"     # Required\n</code></pre>"},{"location":"guides/troubleshooting/#invalid-enum-value","title":"\"Invalid Enum Value\"","text":"<p>Error Message: <pre><code>Error: Invalid value for type: must be 'development' or 'deployment'\n</code></pre></p> <p>Cause: Used invalid value for a restricted field.</p> <p>Solutions:</p> <pre><code># \u274c Wrong\ntype: \"prod\"  # Not a valid option\n\n# \u2705 Correct\ntype: \"deployment\"  # Must be 'development' or 'deployment'\n</code></pre>"},{"location":"guides/troubleshooting/#git-integration-errors","title":"Git Integration Errors","text":""},{"location":"guides/troubleshooting/#github-installation-id-not-found","title":"\"GitHub Installation ID Not Found\"","text":"<p>Error Message: <pre><code>Error: GitHub App installation not found\n</code></pre></p> <p>Causes: - Invalid installation ID - GitHub App not installed on repository - Using wrong git_clone_strategy</p> <p>Solutions:</p> <ol> <li>Find installation ID:</li> <li>Go to GitHub Settings &gt; Applications &gt; dbt Cloud</li> <li> <p>Check URL: <code>/settings/installations/{INSTALLATION_ID}</code></p> </li> <li> <p>Install GitHub App:</p> </li> <li>In dbt Cloud: Admin &gt; Integrations &gt; GitHub</li> <li>Click \"Connect GitHub App\"</li> <li> <p>Authorize for your repositories</p> </li> <li> <p>Update YAML: <pre><code>repository:\n  remote_url: \"https://github.com/org/repo.git\"\n  git_clone_strategy: \"github_app\"\n  github_installation_id: 12345678  # Your installation ID\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#gitlab-project-id-not-found","title":"\"GitLab Project ID Not Found\"","text":"<p>Error Message: <pre><code>Error: GitLab project not found\n</code></pre></p> <p>Cause: Invalid GitLab project ID.</p> <p>Solutions:</p> <ol> <li>Find project ID:</li> <li>In GitLab: Project &gt; Settings &gt; General</li> <li> <p>Look for \"Project ID\" (numeric value)</p> </li> <li> <p>Update YAML: <pre><code>repository:\n  remote_url: \"https://gitlab.com/group/repo.git\"\n  git_clone_strategy: \"deploy_token\"\n  gitlab_project_id: 9876543  # Numeric ID, not name\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#credential-errors","title":"Credential Errors","text":""},{"location":"guides/troubleshooting/#token-not-found-in-token_map","title":"\"Token Not Found in token_map\"","text":"<p>Error Message: <pre><code>Error: Token key 'prod_databricks_token' not found in token_map\n</code></pre></p> <p>Cause: YAML references a token key that doesn't exist in <code>token_map</code>.</p> <p>Solutions:</p> <ol> <li> <p>Check YAML credential name: <pre><code>credential:\n  token_name: \"prod_databricks_token\"  # This key...\n</code></pre></p> </li> <li> <p>Must match token_map: <pre><code>export TF_VAR_token_map='{\n  \"prod_databricks_token\": \"dapi_abc123\"\n  # \u2191 Must match exactly\n}'\n</code></pre></p> </li> <li> <p>Or add to terraform.tfvars: <pre><code>token_map = {\n  prod_databricks_token = \"dapi_abc123\"\n}\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#cicd-issues","title":"CI/CD Issues","text":""},{"location":"guides/troubleshooting/#terraform-init-failed","title":"\"Terraform Init Failed\"","text":"<p>Problem: CI/CD can't initialize Terraform.</p> <p>Solutions:</p> <ol> <li> <p>Check Terraform version: <pre><code>- name: Setup Terraform\n  uses: hashicorp/setup-terraform@v2\n  with:\n    terraform_version: 1.6.0  # Pin specific version\n</code></pre></p> </li> <li> <p>Verify backend access: <pre><code># Ensure CI has permissions to state bucket\n- name: Configure AWS Credentials\n  uses: aws-actions/configure-aws-credentials@v2\n  with:\n    role-to-assume: arn:aws:iam::123456789012:role/terraform\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#secrets-not-available","title":"\"Secrets Not Available\"","text":"<p>Problem: Environment variables are undefined in CI/CD.</p> <p>Solutions:</p> <ol> <li>Verify secrets are defined:</li> <li>GitHub: Settings &gt; Secrets and variables &gt; Actions</li> <li>GitLab: Settings &gt; CI/CD &gt; Variables</li> <li> <p>Azure DevOps: Pipelines &gt; Library</p> </li> <li> <p>Check secret names match: <pre><code>env:\n  TF_VAR_dbt_account_id: ${{ secrets.DBT_ACCOUNT_ID }}\n  # Secret name must match exactly \u2191\n</code></pre></p> </li> <li> <p>Ensure workflow has access: <pre><code># For protected branches\nenvironment:\n  name: production  # Must have access to this environment's secrets\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#performance-issues","title":"Performance Issues","text":""},{"location":"guides/troubleshooting/#terraform-plan-takes-too-long","title":"\"Terraform Plan Takes Too Long\"","text":"<p>Problem: <code>terraform plan</code> runs for minutes.</p> <p>Solutions:</p> <ol> <li> <p>Use targeted plans: <pre><code>terraform plan -target=module.dbt_cloud.module.jobs\n</code></pre></p> </li> <li> <p>Enable parallelism: <pre><code>terraform plan -parallelism=10\n</code></pre></p> </li> <li> <p>Upgrade Terraform: <pre><code># Newer versions have performance improvements\nterraform version\nbrew upgrade terraform  # or similar\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#state-refresh-slow","title":"\"State Refresh Slow\"","text":"<p>Problem: State refresh takes a long time.</p> <p>Solutions:</p> <ol> <li> <p>Skip refresh when safe: <pre><code>terraform plan -refresh=false\n</code></pre></p> </li> <li> <p>Use remote state caching: <pre><code>terraform {\n  backend \"s3\" {\n    # Enable caching\n    skip_metadata_api_check = true\n  }\n}\n</code></pre></p> </li> </ol>"},{"location":"guides/troubleshooting/#debug-mode","title":"Debug Mode","text":"<p>Enable detailed logging:</p> <pre><code># Set debug level\nexport TF_LOG=DEBUG\nexport TF_LOG_PATH=./terraform-debug.log\n\n# Run terraform\nterraform plan\n\n# Review logs\ncat terraform-debug.log\n</code></pre>"},{"location":"guides/troubleshooting/#getting-help","title":"Getting Help","text":"<p>Still stuck? Here's how to get support:</p>"},{"location":"guides/troubleshooting/#1-check-existing-issues","title":"1. Check Existing Issues","text":"<p>Search GitHub Issues for similar problems.</p>"},{"location":"guides/troubleshooting/#2-create-detailed-issue","title":"2. Create Detailed Issue","text":"<p>Include: - Error message (full output) - Terraform version: <code>terraform version</code> - Module version: Check your <code>source</code> URL - Minimal config that reproduces the issue - What you've tried already</p>"},{"location":"guides/troubleshooting/#3-community-support","title":"3. Community Support","text":"<ul> <li>GitHub Discussions</li> <li>dbt Community Slack</li> </ul>"},{"location":"guides/troubleshooting/#common-mistakes","title":"Common Mistakes","text":""},{"location":"guides/troubleshooting/#hardcoding-credentials","title":"\u274c Hardcoding Credentials","text":"<pre><code># DON'T DO THIS!\nvariable \"dbt_token\" {\n  default = \"dbtc_xxxxx\"\n}\n</code></pre>"},{"location":"guides/troubleshooting/#committing-env-file","title":"\u274c Committing .env File","text":"<pre><code># Make sure it's in .gitignore\necho \".env\" &gt;&gt; .gitignore\n</code></pre>"},{"location":"guides/troubleshooting/#using-root-tokens","title":"\u274c Using Root Tokens","text":"<pre><code># Use service accounts, not personal tokens\n# Generate at: dbt Cloud &gt; Admin &gt; Service Tokens\n</code></pre>"},{"location":"guides/troubleshooting/#not-pinning-versions","title":"\u274c Not Pinning Versions","text":"<pre><code># \u274c Bad\nmodule \"dbt\" {\n  source = \"git::https://github.com/...\"\n}\n\n# \u2705 Good\nmodule \"dbt\" {\n  source = \"git::https://github.com/...?ref=v1.0.0\"\n}\n</code></pre>"},{"location":"guides/troubleshooting/#prevention-checklist","title":"Prevention Checklist","text":"<p>Before deployment:</p> <ul> <li> Run <code>terraform fmt -check</code></li> <li> Run <code>terraform validate</code></li> <li> Review <code>terraform plan</code> output</li> <li> Test in non-production first</li> <li> Have rollback plan ready</li> <li> Monitor logs during apply</li> <li> Verify resources in dbt Cloud UI</li> </ul>"},{"location":"guides/troubleshooting/#need-more-help","title":"Need More Help?","text":"<ul> <li> <p> Documentation</p> <p>Review the full documentation</p> <p> Documentation Home</p> </li> <li> <p> GitHub Issues</p> <p>Report bugs or request features</p> <p> Open Issue</p> </li> <li> <p> Discussions</p> <p>Ask questions and share ideas</p> <p> Join Discussion</p> </li> </ul>"},{"location":"reference/module-credentials/","title":"Credentials","text":""},{"location":"reference/module-credentials/#requirements","title":"Requirements","text":"<p>No requirements.</p>"},{"location":"reference/module-credentials/#providers","title":"Providers","text":"Name Version dbtcloud n/a"},{"location":"reference/module-credentials/#modules","title":"Modules","text":"<p>No modules.</p>"},{"location":"reference/module-credentials/#resources","title":"Resources","text":"Name Type dbtcloud_databricks_credential.databricks_credential resource"},{"location":"reference/module-credentials/#inputs","title":"Inputs","text":"Name Description Type Default Required environments_data List of environment configurations, including credentials <code>any</code> n/a yes project_id The ID of the project these credentials belong to <code>string</code> n/a yes token_map Mapping of token names to credential <code>map(string)</code> n/a yes"},{"location":"reference/module-credentials/#outputs","title":"Outputs","text":"Name Description credential_ids Map of environment names to their credential IDs"},{"location":"reference/module-environment_variable_job_overrides/","title":"Environment Variable Job Overrides","text":""},{"location":"reference/module-environment_variable_job_overrides/#requirements","title":"Requirements","text":"<p>No requirements.</p>"},{"location":"reference/module-environment_variable_job_overrides/#providers","title":"Providers","text":"Name Version dbtcloud n/a"},{"location":"reference/module-environment_variable_job_overrides/#modules","title":"Modules","text":"<p>No modules.</p>"},{"location":"reference/module-environment_variable_job_overrides/#resources","title":"Resources","text":"Name Type dbtcloud_environment_variable_job_override.environment_variable_job_overrides resource"},{"location":"reference/module-environment_variable_job_overrides/#inputs","title":"Inputs","text":"Name Description Type Default Required environments_data List of environment configurations, including credentials, overrides <code>any</code> n/a yes job_ids Map of Env Name _ Job Name as key : Job ID <code>any</code> n/a yes project_id The ID of the project to which jobs belong <code>string</code> n/a yes"},{"location":"reference/module-environment_variable_job_overrides/#outputs","title":"Outputs","text":"<p>No outputs.</p>"},{"location":"reference/module-environment_variables/","title":"Environment Variables","text":""},{"location":"reference/module-environment_variables/#requirements","title":"Requirements","text":"<p>No requirements.</p>"},{"location":"reference/module-environment_variables/#providers","title":"Providers","text":"Name Version dbtcloud n/a"},{"location":"reference/module-environment_variables/#modules","title":"Modules","text":"<p>No modules.</p>"},{"location":"reference/module-environment_variables/#resources","title":"Resources","text":"Name Type dbtcloud_environment_variable.environment_variables resource"},{"location":"reference/module-environment_variables/#inputs","title":"Inputs","text":"Name Description Type Default Required environment_ids The ID of the project this repository is associated with <code>map(string)</code> n/a yes environment_variables A list of environment variable configurations <code>any</code> n/a yes project_id The ID of the project to which jobs belong <code>string</code> n/a yes token_map Mapping of token names to credential <code>map(string)</code> n/a yes"},{"location":"reference/module-environment_variables/#outputs","title":"Outputs","text":"<p>No outputs.</p>"},{"location":"reference/module-environments/","title":"Environments","text":""},{"location":"reference/module-environments/#requirements","title":"Requirements","text":"<p>No requirements.</p>"},{"location":"reference/module-environments/#providers","title":"Providers","text":"Name Version dbtcloud n/a"},{"location":"reference/module-environments/#modules","title":"Modules","text":"<p>No modules.</p>"},{"location":"reference/module-environments/#resources","title":"Resources","text":"Name Type dbtcloud_environment.environments resource"},{"location":"reference/module-environments/#inputs","title":"Inputs","text":"Name Description Type Default Required credential_ids A map of environment names to their corresponding credential IDs <code>map(string)</code> <code>{}</code> no environments_data List of environment configurations, including credentials <code>any</code> n/a yes project_id The ID of the project to which environments belong <code>string</code> n/a yes"},{"location":"reference/module-environments/#outputs","title":"Outputs","text":"Name Description environment_ids n/a"},{"location":"reference/module-jobs/","title":"Jobs","text":""},{"location":"reference/module-jobs/#requirements","title":"Requirements","text":"<p>No requirements.</p>"},{"location":"reference/module-jobs/#providers","title":"Providers","text":"Name Version dbtcloud n/a"},{"location":"reference/module-jobs/#modules","title":"Modules","text":"<p>No modules.</p>"},{"location":"reference/module-jobs/#resources","title":"Resources","text":"Name Type dbtcloud_job.job resource"},{"location":"reference/module-jobs/#inputs","title":"Inputs","text":"Name Description Type Default Required environment_ids The ID of the project this repository is associated with <code>map(string)</code> n/a yes environments_data List of environment configurations, including credentials <code>any</code> n/a yes project_id The ID of the project to which jobs belong <code>string</code> n/a yes"},{"location":"reference/module-jobs/#outputs","title":"Outputs","text":"Name Description job_ids n/a"},{"location":"reference/module-project/","title":"Project","text":""},{"location":"reference/module-project/#requirements","title":"Requirements","text":"<p>No requirements.</p>"},{"location":"reference/module-project/#providers","title":"Providers","text":"Name Version dbtcloud n/a"},{"location":"reference/module-project/#modules","title":"Modules","text":"<p>No modules.</p>"},{"location":"reference/module-project/#resources","title":"Resources","text":"Name Type dbtcloud_project.project resource"},{"location":"reference/module-project/#inputs","title":"Inputs","text":"Name Description Type Default Required project_name Project name <code>string</code> n/a yes target_name Target CI or Production <code>string</code> n/a yes"},{"location":"reference/module-project/#outputs","title":"Outputs","text":"Name Description project_id n/a"},{"location":"reference/module-project_repository/","title":"Project Repository","text":""},{"location":"reference/module-project_repository/#requirements","title":"Requirements","text":"<p>No requirements.</p>"},{"location":"reference/module-project_repository/#providers","title":"Providers","text":"Name Version dbtcloud n/a"},{"location":"reference/module-project_repository/#modules","title":"Modules","text":"<p>No modules.</p>"},{"location":"reference/module-project_repository/#resources","title":"Resources","text":"Name Type dbtcloud_project_repository.project_repository resource"},{"location":"reference/module-project_repository/#inputs","title":"Inputs","text":"Name Description Type Default Required project_id The ID of the project this repository is associated with <code>string</code> n/a yes repository_id The ID of the repository this project is associated with <code>string</code> n/a yes"},{"location":"reference/module-project_repository/#outputs","title":"Outputs","text":"Name Description project_repository_id n/a"},{"location":"reference/module-repository/","title":"Repository","text":""},{"location":"reference/module-repository/#requirements","title":"Requirements","text":"<p>No requirements.</p>"},{"location":"reference/module-repository/#providers","title":"Providers","text":"Name Version dbtcloud 1.3.0 null 3.2.4"},{"location":"reference/module-repository/#modules","title":"Modules","text":"<p>No modules.</p>"},{"location":"reference/module-repository/#resources","title":"Resources","text":"Name Type dbtcloud_repository.repository resource null_resource.validation resource"},{"location":"reference/module-repository/#inputs","title":"Inputs","text":"Name Description Type Default Required project_id The ID of the dbt Cloud project this repository is associated with <code>string</code> n/a yes repository_data Repository configuration object with auto-detection and validation.Supported providers (auto-detected from remote_url):  - GitHub: https://github.com/* or git@github.com:* (supports github_app strategy)  - GitLab: https://gitlab.com/* or git@gitlab.com:* (supports deploy_token strategy)  - Azure DevOps: https://dev.azure.com/* or git@ssh.dev.azure.com:* (supports azure_active_directory_app strategy)  - Bitbucket: https://bitbucket.org/* (uses deploy_key strategy)  - Generic: Any other URL (uses deploy_key strategy)Required fields:  - remote_url: Git repository URL (HTTPS or SSH)Optional fields depend on git_clone_strategy:  - git_clone_strategy: Auto-detected, but can be explicitly set to:      * deploy_key (default for all providers)      * github_app (GitHub only, requires github_installation_id)      * deploy_token (GitLab only, requires gitlab_project_id)      * azure_active_directory_app (Azure DevOps only, requires azure_active_directory_project_id and azure_active_directory_repository_id)   - github_installation_id: (GitHub app integration only) Integer ID of GitHub App installation  - gitlab_project_id: (GitLab integration only) Integer ID of GitLab project  - azure_active_directory_project_id: (Azure DevOps only) UUID of Azure DevOps project  - azure_active_directory_repository_id: (Azure DevOps only) UUID of Azure DevOps repository  - azure_bypass_webhook_registration_failure: (Azure DevOps only) Boolean, default false   - is_active: Boolean, default true  - private_link_endpoint_id: Optional private link endpoint ID (all providers)  - pull_request_url_template: Optional custom PR URL template (all providers)Example GitHub with GitHub App:  repository = {    remote_url = \"https://github.com/myorg/myrepo.git\"    git_clone_strategy = \"github_app\"    github_installation_id = 12345678  }Example GitLab with Deploy Token:  repository = {    remote_url = \"https://gitlab.com/mygroup/myproject.git\"    git_clone_strategy = \"deploy_token\"    gitlab_project_id = 9876543  }Example Azure DevOps:  repository = {    remote_url = \"https://dev.azure.com/myorg/myproject/_git/myrepo\"    git_clone_strategy = \"azure_active_directory_app\"    azure_active_directory_project_id = \"550e8400-e29b-41d4-a716-446655440000\"    azure_active_directory_repository_id = \"550e8400-e29b-41d4-a716-446655440001\"  }Example Generic (SSH Deploy Key):  repository = {    remote_url = \"git@github.com:myorg/myrepo.git\"  } <code>any</code> n/a yes"},{"location":"reference/module-repository/#outputs","title":"Outputs","text":"Name Description project_repository_id n/a repository_id n/a"},{"location":"reference/terraform/","title":"Module API","text":""},{"location":"reference/terraform/#requirements","title":"Requirements","text":"Name Version terraform &gt;= 1.0 dbtcloud ~&gt; 1.3"},{"location":"reference/terraform/#providers","title":"Providers","text":"<p>No providers.</p>"},{"location":"reference/terraform/#modules","title":"Modules","text":"Name Source Version credentials ./modules/credentials n/a environment_variable_job_overrides ./modules/environment_variable_job_overrides n/a environment_variables ./modules/environment_variables n/a environments ./modules/environments n/a jobs ./modules/jobs n/a project ./modules/project n/a project_repository ./modules/project_repository n/a repository ./modules/repository n/a"},{"location":"reference/terraform/#resources","title":"Resources","text":"<p>No resources.</p>"},{"location":"reference/terraform/#inputs","title":"Inputs","text":"Name Description Type Default Required dbt_account_id dbt Cloud account ID <code>number</code> n/a yes dbt_host_url dbt Cloud host URL (e.g., https://cloud.getdbt.com or custom domain) <code>string</code> n/a yes dbt_pat n/a <code>string</code> <code>\"\"</code> no dbt_token dbt Cloud API token for authentication <code>string</code> n/a yes target_name Default target name for the dbt project (e.g., 'dev', 'prod') <code>string</code> <code>\"\"</code> no token_map Map of credential token names to their actual values (e.g., Databricks tokens). Token names should correspond to credential.token_name in YAML. <code>map(string)</code> <code>{}</code> no yaml_file Path to the YAML file defining dbt Cloud resources (projects, environments, jobs, etc.) <code>string</code> n/a yes"},{"location":"reference/terraform/#outputs","title":"Outputs","text":"Name Description credential_ids Map of credential names to their dbt Cloud IDs environment_ids Map of environment names to their dbt Cloud IDs job_ids Map of job names to their dbt Cloud IDs project_id The dbt Cloud project ID repository_id The dbt Cloud repository ID"}]}